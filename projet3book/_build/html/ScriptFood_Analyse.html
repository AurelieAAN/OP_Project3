
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contexte du projet &#8212; My sample book</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">My sample book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Rechercher dans ce livre ..." aria-label="Rechercher dans ce livre ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Contexte du projet
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Basculer la navigation" aria-controls="site-navigation"
                title="Basculer la navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Téléchargez cette page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/ScriptFood_Analyse.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Télécharger le fichier notebook" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/ScriptFood_Analyse.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Télécharger le fichier source" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimer au format PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Dépôt source"><i
                    class="fab fa-github"></i>dépôt</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FScriptFood_Analyse.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Ouvrez un problème"><i class="fas fa-lightbulb"></i>signaler un problème</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Mode plein écran"
        title="Mode plein écran"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/ScriptFood_Analyse.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="lancement Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contenu
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Contexte du projet
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problematique-comment-ameliorer-la-sante-des-francais">
     Problématique : Comment améliorer la santé des français ?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#but-de-letude">
     But de l’étude :
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#methode">
     Methode :
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#construction-de-la-base-de-donnees">
   Construction de la base de données
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploration-de-nos-donnees">
     Exploration  de nos données
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nettoyage-des-donnees">
     Nettoyage des données
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#detection-des-doublons">
       Détection des doublons
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploration-des-donnees">
   Exploration des données
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-quantitatives">
     Variables quantitatives
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#etudes-des-valeurs-aberrantes">
       Etudes des valeurs aberrantes
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#commencons-par-la-variable-proteins-100g">
       Commençons par la variable proteins_100g
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#regardons-a-present-la-variable-saturated-fat-100g">
       Regardons à présent la variable saturated-fat_100g
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#etudions-la-variable-fiber-100g">
       Etudions la variable fiber_100g
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#passons-a-la-variable-salt-100g">
       Passons à la variable salt_100g
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maintenant-que-nous-avons-supprime-nos-donnees-aberrantes-nous-pouvons-recalculer-nos-statistiques-et-retracer-des-violinplots">
       Maintenant que nous avons supprimé nos données aberrantes, nous pouvons recalculer nos statistiques et retracer des violinplots
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maintenant-etudions-les-distributions-de-nos-differentes-variables">
       Maintenant, étudions les distributions de nos différentes variables.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#realisons-un-test-de-skewness-pour-confirmer">
       Réalisons un Test de skewness pour confirmer.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#verifions-comment-nos-variables-se-comportent-par-rapport-a-la-loi-normale-grece-au-test-de-kurtosis">
       Vérifions comment nos variables se comportent par rapport à la loi normale grêce au test de kurtosis.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#faisons-un-test-pour-verifier-que-nos-distributions-ne-suivent-pas-une-loi-normale">
       Faisons un test pour vérifier que nos distributions ne suivent pas une loi normale.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creons-des-regroupements-afin-que-nos-distributions-soient-mieux-reparties-et-que-nos-variables-soient-plus-pertinentes-pour-la-suite">
     Créons des regroupements afin que nos distributions soient mieux réparties et que nos variables soient plus pertinentes pour la suite.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#commencons-par-la-variable-additives-n">
       Commençons par la variable additives_n
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#passons-a-la-variable-energy-100g">
       Passons à la variable energy_100g
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#etudions-la-distribution-de-la-variable-fat-100g">
       Etudions la distribution de la variable fat_100g
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#passons-a-la-variable-saturated-fat-100g">
       Passons à la variable saturated_fat_100g
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#etudions-la-variable-carbohydrates-100g">
       Etudions la variable carbohydrates_100g
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conclusion-des-variables-quantitatives">
     Conclusion des variables quantitatives
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variables-qualitatives">
       Variables qualitatives
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#commencons-par-la-variable-product-name">
         Commençons par la variable product_name
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#regardons-la-variable-quantity">
         Regardons la variable quantity
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#etudions-les-variables-packaging-et-packaging-tags">
         Etudions les variables packaging et packaging_tags
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#etudions-la-variable-main-category">
         Etudions la variable main_category
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#regardons-la-variable-ingredients-text">
         Regardons la variable ingredients_text
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#etudions-les-variables-states-states-tags-et-state-fr">
         Etudions les variables states, states_tags et state_fr
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#observons-les-variables-additives-tags-et-additives-fr">
         Observons les variables additives_tags et	additives_fr
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#analysons-a-present-la-variable-nutrition-grade-fr">
         Analysons à présent la variable nutrition_grade_fr
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#etudions-la-variable-ingredients-from-palm-oil">
         Etudions la variable ingredients_from_palm_oil
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#passons-aux-variables-pnns-groups-1-et-pnns-groups-2">
         Passons aux variables pnns_groups_1 et pnns_groups_2
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#decrivons-nos-donnees-en-regardons-le-nombre-d-aliments-par-date-de-creation-des-fiches">
         Décrivons nos données en regardons le nombre d’aliments par date de création des fiches.
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#regardons-d-ou-provient-la-majorite-des-aliments-grace-a-la-variable-countries">
         Regardons d’où provient la majorité des aliments grâce à la variable countries.
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id1">
         Analysons à présent la variable nutrition_grade_fr
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conclusion-qualitatives">
     Conclusion qualitatives
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#est-ce-que-le-nutriscore-contribue-a-ameliorer-la-sante-des-francais-dans-ce-but-est-ce-que-le-nutriscore-permet-de-manger-equilibrer">
   Est-ce que le nutriscore contribue à améliorer la santé des français ? Dans ce but, est ce que le nutriscore permet de manger équilibrer ?
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nos-variables">
     Nos variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quels-sont-ses-caracteristiques">
     Quels sont ses caractéristiques ?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#techniquement-voici-les-elements-qui-agit-sur-le-nutriscore">
       Techniquement, voici les éléments qui agit sur le nutriscore :
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#est-ce-que-si-nous-mangeons-que-des-aliments-avec-un-nutriscore-a-serons-nous-en-bonne-sante">
     Est - ce que si nous mangeons que des aliments avec un nutriscore A, serons - nous en bonne santé ?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#comparons-les-informations-des-differentes-notes">
       Comparons les informations  des différentes notes.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analyse-bivariee-etudions-le-lien-entre-la-variable-nutrition-grade-fr-et-les-autres-variables">
       Analyse bivariée : Etudions le lien entre la variable nutrition_grade_fr et les autres variables.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#confirmons-nos-resultats-precedents-en-verifiant-le-lien-entre-nos-variables-quantitatives-et-le-grade-du-nutriscore">
       Confirmons nos résultats précédents en vérifiant le lien entre nos variables quantitatives et le grade du nutriscore
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#l-independance-entre-nos-groupes">
       L’indépendance entre nos groupes
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#l-egalite-des-variances">
       L’égalité des variances
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#les-residus-doivent-suivre-une-loi-normale">
         Les résidus doivent suivre une loi normale
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#utilisons-le-test-de-krusdall-utilise-les-rangs-au-lieu-des-moyennes">
       Utilisons le test de Krusdall (utilise les rangs au lieu des moyennes)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conclusion-nutriscore">
     Conclusion Nutriscore
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#objectif-une-meilleure-sante-pour-tous-application-smart-food">
   Objectif une meilleure santé pour tous : Application Smart Food
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classement-des-aliments">
     Classement des aliments
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#utilisation-des-variables-quantitatives-contenant-les-notes">
     Utilisation des variables quantitatives contenant les notes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combinaison-des-aliments">
   Combinaison des aliments
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="contexte-du-projet">
<h1>Contexte du projet<a class="headerlink" href="#contexte-du-projet" title="Permalink to this headline">¶</a></h1>
<div class="section" id="problematique-comment-ameliorer-la-sante-des-francais">
<h2>Problématique : Comment améliorer la santé des français ?<a class="headerlink" href="#problematique-comment-ameliorer-la-sante-des-francais" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="but-de-letude">
<h2>But de l’étude :<a class="headerlink" href="#but-de-letude" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Est-ce que le nutriscore y contribue ?</p></li>
<li><p>Si non, comment pouvons -  nous améliorer la santé de la population ?</p></li>
</ul>
</div>
<div class="section" id="methode">
<h2>Methode :<a class="headerlink" href="#methode" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Découvrir les caractéristiques du nutriscore et son intérêt</p></li>
<li><p>Etudier les autres moyens à notre disposition pour améliorer l’efficacité du nutriscore ou apporter de nouvelles solutions</p></li>
</ul>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="construction-de-la-base-de-donnees">
<h1>Construction de la base de données<a class="headerlink" href="#construction-de-la-base-de-donnees" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exploration-de-nos-donnees">
<h2>Exploration  de nos données<a class="headerlink" href="#exploration-de-nos-donnees" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">missingno</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">Package</span> <span class="kn">import</span> <span class="n">Scripts_Analyse01</span> <span class="k">as</span> <span class="n">pk</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">yellowbrick.features</span> <span class="kn">import</span> <span class="n">ParallelCoordinates</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objects</span> <span class="kn">import</span> <span class="n">Layout</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_22708</span><span class="o">/</span><span class="mf">2313245602.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">Package</span> <span class="kn">import</span> <span class="n">Scripts_Analyse01</span> <span class="k">as</span> <span class="n">pk</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;Package&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./Data/fr.openfoodfacts.org.products.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>Nous disposons de 320 772 produits alimentaires et de 162 colonnes.</p>
<p>Regardons le nom des colonnes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous disposons du détail des aliments en fonction notamment des apports nutritionnels.</p>
<p>Regardons quel type de variables nous avons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Essayons de transformer les variables object en string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#pk.data_transformcol_string(data)</span>
</pre></div>
</div>
</div>
</div>
<p>Etudions un extrait de nos donnéees.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous observons beaucoup de données manquantes. Regardons les variables avec plus de 80 %  de données manquantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">del_Nan</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">tab</span>
</pre></div>
</div>
</div>
</div>
<p>Ces variables n’apportent pas suffisament d’information. Nous pouvons les supprimer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">del_Nan</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>Il nous reste 54 variables.</p>
<p>Regardons si des variables ne sont pas utiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<p>Certaines variables ne sont pas utiles pour notre analyse comme l’url des fiches ou la date de dernière modification.
Nous pouvons donc les supprimer et conserver par exemple la date de création de la fiche aliment.
Voici les colonnes que nous supprimons :
url, creator, created_t, image_url, image_small_url, last_modified_t, last_modified_datetime</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;creator&quot;</span><span class="p">,</span> <span class="s2">&quot;created_t&quot;</span><span class="p">,</span><span class="s2">&quot;image_url&quot;</span><span class="p">,</span><span class="s2">&quot;image_small_url&quot;</span><span class="p">,</span> <span class="s2">&quot;last_modified_t&quot;</span><span class="p">,</span> <span class="s2">&quot;last_modified_datetime&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ensuite, nous pouvons supprimer les variables avec des données uniques.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">data_uniqueone_string</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>A présent, nous pouvons tracer la matrice des données manquantes pour mieux observer ces valeurs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">matrix_vm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.60</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Il reste beaucoup de données manquantes. Mais nous pouvons créer des catégories N.A pour les variables qualitatives</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">data_fillNA_string</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;AUTRES&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">matrix_vm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Il semble que des colonnes avec plus de 50% de données manquantes soient encore présentes.
Regardons de plus près ces colonnes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_value_df</span> <span class="o">=</span> <span class="n">pk</span><span class="o">.</span><span class="n">data_missingTab</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">graph_int_bar</span><span class="p">(</span><span class="n">data_i</span><span class="p">,</span> <span class="n">x_i</span><span class="p">,</span> <span class="n">y_i</span><span class="p">,</span> <span class="n">x_label_i</span><span class="p">,</span> <span class="n">y_label_i</span><span class="p">,</span> <span class="n">palette_color_i</span><span class="p">,</span> <span class="n">title_i</span><span class="p">):</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x_i</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">y_i</span><span class="p">,</span> 
             <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="n">x_i</span><span class="p">:</span><span class="n">x_label_i</span><span class="p">,</span><span class="n">y_i</span><span class="p">:</span><span class="n">y_label_i</span><span class="p">},</span>
              <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">palette_color_i</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="n">title_i</span><span class="p">,</span> <span class="c1"># title of plot</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ms</span> <span class="o">=</span><span class="n">missing_value_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missing_value_df</span><span class="p">[</span><span class="s2">&quot;percent_missing&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">]</span>
<span class="n">graph_int_bar</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="s1">&#39;column_name&#39;</span><span class="p">,</span> <span class="s1">&#39;percent_missing&#39;</span><span class="p">,</span> <span class="s2">&quot;Variables&quot;</span><span class="p">,</span> <span class="s2">&quot;% - Valeurs manquantes&quot;</span><span class="p">,</span> <span class="s2">&quot;fall&quot;</span><span class="p">,</span> <span class="s2">&quot;Variables avec plus de 50</span><span class="si">% d</span><span class="s2">e valeurs manquantes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous décidons de supprimer ces colonnes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">del_Nan</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Regardons les données manquantes restantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_value_df</span> <span class="o">=</span> <span class="n">pk</span><span class="o">.</span><span class="n">data_missingTab</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">ms</span> <span class="o">=</span><span class="n">missing_value_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">missing_value_df</span><span class="p">[</span><span class="s2">&quot;percent_missing&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
<span class="n">graph_int_bar</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="s1">&#39;column_name&#39;</span><span class="p">,</span> <span class="s1">&#39;percent_missing&#39;</span><span class="p">,</span> <span class="s2">&quot;Variables&quot;</span><span class="p">,</span> <span class="s2">&quot;% - Valeurs manquantes&quot;</span><span class="p">,</span> <span class="s2">&quot;fall&quot;</span><span class="p">,</span> <span class="s2">&quot;Répartition des variables en fonction de leur pourcentage de valeurs manquantes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il reste peu de données manquantes.</p>
<p>Nous conservons nos données telle quelle pour ne pas perdre d’information.</p>
<p>Regardons quelques statistiques descriptives sur nos variables restantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Renommons les variables qui contiennent des tirets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;saturated-fat_100g&#39;</span><span class="p">:</span> <span class="s1">&#39;saturated_fat_100g&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;nutrition-score-fr_100g&#39;</span><span class="p">:</span> <span class="s1">&#39;nutrition_score_fr_100g&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>Nous avons conservé 41 colonnes.
Passons au nettoyage de nos données.</p>
</div>
<div class="section" id="nettoyage-des-donnees">
<h2>Nettoyage des données<a class="headerlink" href="#nettoyage-des-donnees" title="Permalink to this headline">¶</a></h2>
<div class="section" id="detection-des-doublons">
<h3>Détection des doublons<a class="headerlink" href="#detection-des-doublons" title="Permalink to this headline">¶</a></h3>
<p>Vérifions s’ils existent des doublons (toutes les colonnes identiques), mettons d’abord toutes les catégories en majuscule.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">data_majuscule</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>On considère comme produit identique les lignes qui ont le même nom de produit et le même code barre.
En effet, il est noté que des articles différents peuvent avoir le même code barre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;product_name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Regardons ces doublons</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_doublons</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;product_name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">),:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_doublons</span>
</pre></div>
</div>
</div>
</div>
<p>Ces produits ne sont pas forcément des doublons car ils ne contiennent pas de code identifiant les produits.</p>
<p>Cependant, Le nom  des produits semblent correspondre au pays de provenance et ces lignes ne contiennent pas beaucoup d’informations. Nous observons beaucoup de valeurs manquantes.</p>
<p>Nous décidons de supprimer ces lignes afin de ne pas fausser nos résultats car il semble que la saisie de ces produits ait été mal réalisée.</p>
<p>Faisons une jointure entre notre dataframe de base et notre dataframe qui contient les lignes mal renseignées.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_doublons</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;_del&#39;</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Maintenant que nous avons identifié ces lignes dans le dataframe de base, on peut les supprimer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_result</span> <span class="o">=</span> <span class="n">data_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_result</span><span class="p">[</span><span class="s2">&quot;_merge&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;left_only&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_merge&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Conservons les colonnes de notre dataframe de base.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_result</span> <span class="o">=</span> <span class="n">data_result</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data_result</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_del&#39;</span><span class="p">)]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">data_result</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;product_name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>Création d’une colonne présence possible d’huile de palme :
Nous vérifions s’il y a de l’huile de palme possible et s’il y en a dans les ingredients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">ingredients_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;PALM&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">True</span>  <span class="p">,</span> <span class="s2">&quot;ingredients_from_palm_oil&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;OUI&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">ingredients_from_palm_oil_n</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;ingredients_from_palm_oil&quot;</span> <span class="p">]</span><span class="o">=</span><span class="s2">&quot;OUI&quot;</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">ingredients_that_may_be_from_palm_oil_n</span><span class="o">&gt;=</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;ingredients_from_palm_oil&quot;</span> <span class="p">]</span><span class="o">=</span><span class="s2">&quot;OUI&quot;</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;ingredients_from_palm_oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;NON&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">matrix_vm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.43</span><span class="p">,</span><span class="mf">0.51</span><span class="p">,</span><span class="mf">0.38</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Supprimons les données qui n’ont aucune colonne quantitatives renseignées (fin _100g).
En effet, ces colonnes nous permettront de réaliser notre analyse donc il nous faut au moins une information remplie pour une donnée.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">carbohydrates_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> 
              <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">proteins_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">fat_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
        <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiber_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
         <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sugars_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
        <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;salt_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
             <span class="o">|</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;sodium_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>Il reste encore certaines données manquantes, mais les individus apportent suffisamment d’informations pour les conserver.</p>
<p>Passons à la prochaine étape : Etudions chacune de nos variables.</p>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="exploration-des-donnees">
<h1>Exploration des données<a class="headerlink" href="#exploration-des-donnees" title="Permalink to this headline">¶</a></h1>
<div class="section" id="variables-quantitatives">
<h2>Variables quantitatives<a class="headerlink" href="#variables-quantitatives" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>il semble qu’il y a ait des données aberrantes. Nous avons des données négatives pour certaines variables.
Et nous avons des maximums étonnant comparés au 3ème quartile. Même si l’écart-type n’est pas très important.</p>
<div class="section" id="etudes-des-valeurs-aberrantes">
<h3>Etudes des valeurs aberrantes<a class="headerlink" href="#etudes-des-valeurs-aberrantes" title="Permalink to this headline">¶</a></h3>
<p>Traçons des stripplots pour toutes nos variables quantitatives. Ces graphiques permettent plus facilement d’observer les valeurs extrêmes pour de grands volumes de données.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">pk</span><span class="o">.</span><span class="n">graph_stripplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;Nuage de point de la variable &quot;</span><span class="o">+</span><span class="n">col</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&quot;#6D8260&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous observons des données extrêmes dites données aberrantes pour presque toutes nos variables.</p>
<p>Pour rappel, les valeurs aberrantes sont des données qui ne sont pas anodines pour le jeu de données dont on dispose.</p>
<p>Commençons par essayer de supprimer ces données grâce aux informations sur internet.
Nous découvrons que l’aliment le plus calorique contient 900 calories. Nous pouvons donc supprimer les données supérieures ou égales à 901 calories.</p>
<p>source : <a class="reference external" href="https://sante.journaldesfemmes.fr/calories/classement/aliments/calories">https://sante.journaldesfemmes.fr/calories/classement/aliments/calories</a> (provenant de l’Anses)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy_100g&#39;</span><span class="p">],</span> <span class="mi">901</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Pour l’instant pour chacunes de ces colonnes, nous pouvons supprimer toutes les données supérieures à la portion de 100g et inférieures à 0.</p>
<p>Nous pourrions calculer l’écart-interquartile, mais celui-ci ne serait pas adapté à ces données. En effet certains aliments peuvent être très proche de 100g et d’autres proche de 0.</p>
<p>Calculons quand même un exemple pour la variable energy_100g</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">outliers</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy_100g&#39;</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous obtenons un écart-interquartile de 1 148 pour la valeur haute (donc largement au-dessus de 901 calories).
Et nous obtenons une valeur inférieur à 0 pour les valeurs basses. Ce qui n’est pas possible pour les nutritions d’un aliment.</p>
<p>Ce calcul n’est donc pas adaptées à nos données car elles sont irréelles par rapport aux aliments.</p>
<p>Supprimons les données supérieures à 100g et inférieurs ou égales à 0 pour les autres “nutriments”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;carbohydrates_100g&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;proteins_100g&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fat_100g&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;saturated_fat_100g&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fiber_100g&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sugars_100g&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_UPPER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;salt_100g&#39;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;carbohydrates_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;proteins_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fat_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;saturated_fat_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fiber_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sugars_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">delete_outliers_LOWER</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;salt_100g&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Retraçons nos stripplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">pk</span><span class="o">.</span><span class="n">graph_stripplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;Nuage de point de la variable &quot;</span><span class="o">+</span><span class="n">col</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Regardons plus précisément les variables proteins_100g, saturated-fat_100g, fiber_1100g, il semble qu’il reste des valeurs aberrantes.</p>
</div>
<div class="section" id="commencons-par-la-variable-proteins-100g">
<h3>Commençons par la variable proteins_100g<a class="headerlink" href="#commencons-par-la-variable-proteins-100g" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">boxplot_int</span><span class="p">(</span><span class="n">data_var_i</span><span class="p">,</span><span class="n">y_label_i</span><span class="p">,</span> <span class="n">palette_color_i</span> <span class="p">,</span> <span class="n">mean_i</span><span class="p">):</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;rgba(0,0,0,0)&#39;</span><span class="p">)</span>

    <span class="c1"># Use that layout here</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mean_i</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data_var_i</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">y_label_i</span><span class="p">,</span> 
                        <span class="n">marker_color</span> <span class="o">=</span> <span class="n">palette_color_i</span><span class="p">,</span> <span class="n">boxmean</span><span class="o">=</span><span class="s1">&#39;sd&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data_var_i</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">y_label_i</span><span class="p">,</span> 
                        <span class="n">marker_color</span> <span class="o">=</span> <span class="n">palette_color_i</span><span class="p">))</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Boite à moustache de la variable &quot;</span><span class="o">+</span><span class="n">y_label_i</span><span class="p">,</span> <span class="c1"># title of plot</span>
    <span class="p">)</span>
    

    
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxplot_int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">proteins_100g</span><span class="p">,</span> <span class="s2">&quot;Protéine&quot;</span><span class="p">,</span> <span class="s2">&quot;indianred&quot;</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>L’aliment le plus protéiné est : gélatine alimentaire	87,6 g</p>
<p>source : <a class="reference external" href="https://sante.journaldesfemmes.fr/calories/classement/aliments/proteines">https://sante.journaldesfemmes.fr/calories/classement/aliments/proteines</a></p>
<p>Supprimons les données qui ont des protéines supérieures à 89g.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;proteins_100g&quot;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">89</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Regardons à nouveau la boxenplot de la variable proteins_100g.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxplot_int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">proteins_100g</span><span class="p">,</span> <span class="s2">&quot;Protéine&quot;</span><span class="p">,</span> <span class="s2">&quot;indianred&quot;</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il reste quelques valeurs extrêmes mais elles sont cohérentes, donc on les conserve pour ne pas perdre d’information.</p>
<p>Les données ne sont pas très dispersées la boite à moustache est aplatie.</p>
</div>
<div class="section" id="regardons-a-present-la-variable-saturated-fat-100g">
<h3>Regardons à présent la variable saturated-fat_100g<a class="headerlink" href="#regardons-a-present-la-variable-saturated-fat-100g" title="Permalink to this headline">¶</a></h3>
<p>Nous savons que l’aliment qui contient le plus d’acide gras saturés est : pain de friture	92,6 g</p>
<p>source: <a class="reference external" href="https://sante.journaldesfemmes.fr/calories/classement/aliments/acides-gras-satures">https://sante.journaldesfemmes.fr/calories/classement/aliments/acides-gras-satures</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">93</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">graph_int_violin</span><span class="p">(</span><span class="n">data_var_i</span><span class="p">,</span> <span class="n">fillcolor_i</span><span class="p">,</span> <span class="n">x_label_i</span><span class="p">):</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;rgba(0,0,0,0)&#39;</span><span class="p">)</span>

    <span class="c1"># Use that layout here</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Violin</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data_var_i</span><span class="p">,</span> <span class="n">box_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                               <span class="n">meanline_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="n">fillcolor_i</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                               <span class="n">x0</span><span class="o">=</span><span class="n">x_label_i</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>


    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Violinplot de la variable &quot;</span><span class="o">+</span><span class="n">x_label_i</span><span class="p">,</span> <span class="n">yaxis_zeroline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_int_violin</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;saturated_fat_100g&#39;</span><span class="p">],</span> <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il reste des données extrêmes. Mais elles sont cohérentes. Donc nous allons les conserver.</p>
</div>
<div class="section" id="etudions-la-variable-fiber-100g">
<h3>Etudions la variable fiber_100g<a class="headerlink" href="#etudions-la-variable-fiber-100g" title="Permalink to this headline">¶</a></h3>
<p>Pour information, l’aliment le plus riche en fibre est la cannelle avec 43,5g (pour 100g).</p>
<p>source: <a class="reference external" href="https://sante.journaldesfemmes.fr/calories/classement/aliments/fibres">https://sante.journaldesfemmes.fr/calories/classement/aliments/fibres</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiber_100g&quot;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">45</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Traçons un violinplot pour observer ces modifications</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_int_violin</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;fiber_100g&#39;</span><span class="p">],</span> <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span> <span class="s2">&quot;fiber_100g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous observons que nos données sont concentrées en bas du violinplot.</p>
</div>
<div class="section" id="passons-a-la-variable-salt-100g">
<h3>Passons à la variable salt_100g<a class="headerlink" href="#passons-a-la-variable-salt-100g" title="Permalink to this headline">¶</a></h3>
<p>Traçons un boxenplot qui est comme une boite à moustache sauf qu’il a plus de quantiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_boxenplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;salt_100g&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span><span class="s2">&quot;Boxenplot du sel contenu (sur 100g) dans les aliments&quot;</span><span class="p">,(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous observons que les données sont regroupées à gauche du graphique. Il y a des valeurs très extrêmes.</p>
<p>L’aliment le plus riche en sel est : sel non iodé non fluoré avec 39100 mg</p>
<p>source : <a class="reference external" href="https://sante.journaldesfemmes.fr/calories/classement/aliments/sel">https://sante.journaldesfemmes.fr/calories/classement/aliments/sel</a></p>
<p>Supprimons les données supérieurs à 41g.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;salt_100g&quot;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">40</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxplot_int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">salt_100g</span><span class="p">,</span> <span class="s2">&quot;salt_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;indianred&quot;</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il reste des valeurs extrêmes mais nous les conservons car elles sont réelles.</p>
</div>
<div class="section" id="maintenant-que-nous-avons-supprime-nos-donnees-aberrantes-nous-pouvons-recalculer-nos-statistiques-et-retracer-des-violinplots">
<h3>Maintenant que nous avons supprimé nos données aberrantes, nous pouvons recalculer nos statistiques et retracer des violinplots<a class="headerlink" href="#maintenant-que-nous-avons-supprime-nos-donnees-aberrantes-nous-pouvons-recalculer-nos-statistiques-et-retracer-des-violinplots" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">pk</span><span class="o">.</span><span class="n">graph_boxplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;Boite à moustache de la variable &quot;</span><span class="o">+</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>On a des données à -15 pour les nutritions score, mais cela est possible.
source : <a class="reference external" href="https://www.santepubliquefrance.fr/media/files/02-determinants-de-sante/nutrition-et-activite-physique/nutri-score/qr-scientifique-technique-en">https://www.santepubliquefrance.fr/media/files/02-determinants-de-sante/nutrition-et-activite-physique/nutri-score/qr-scientifique-technique-en</a> =&gt; voir page 27</p>
<p>Le min est -15 et le max 40.</p>
<p>Nous remarquons que les écart-type de nos variables sont assez faibles et que les boites à moustache sont toutes assez resserrées. Ainsi, nos données sont peu dispersées au sein de nos variables quantitatives.</p>
<p>Nous apprenons plusieurs informations sur nos aliments (sur 100g) :</p>
<ul class="simple">
<li><p>75% des aliments contiennent moins de 2 additifs et non pas d’huile de palme</p></li>
<li><p>50% des aliments apportent plus de 362 calories (energie en calorie)</p></li>
<li><p>75 % des aliments contiennent moins de 5g de matières grasses et moins de 1.60g de matières grasses saturées</p></li>
<li><p>25% des aliments contiennent moins de 4.20g de carbohydrates</p></li>
<li><p>50% des aliments contiennent moins de 3.50g de sucres et moins de 0.46g de sels</p></li>
<li><p>25% des aliments ont moins de 0.03g de sodium</p></li>
<li><p>75% des aliments ont moins de 1.90g de fibres et moins de 6.59g de protéines</p></li>
</ul>
<p>De plus, nous savons que 75% de nos aliments ont une note au nutriscore fr inférieure à 5 et que le maximum est 32.</p>
</div>
<div class="section" id="maintenant-etudions-les-distributions-de-nos-differentes-variables">
<h3>Maintenant, étudions les distributions de nos différentes variables.<a class="headerlink" href="#maintenant-etudions-les-distributions-de-nos-differentes-variables" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hist_int</span><span class="p">(</span><span class="n">data_var_i</span><span class="p">,</span> <span class="n">color_i</span><span class="p">,</span> <span class="n">title_i</span><span class="p">,</span> <span class="n">x_label_i</span><span class="p">,</span> <span class="n">y_label_i</span><span class="p">):</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;rgba(0,0,0,0)&#39;</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data_var_i</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;control&#39;</span><span class="p">,</span> <span class="c1"># name used in legend and hover labels</span>
        <span class="n">xbins</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span> <span class="c1"># bins used for histogram</span>
            <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">4</span>
        <span class="p">),</span>
        <span class="n">marker_color</span><span class="o">=</span><span class="n">color_i</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span>
    <span class="p">))</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="n">title_i</span><span class="p">,</span> <span class="c1"># title of plot</span>
        <span class="n">xaxis_title_text</span><span class="o">=</span><span class="n">x_label_i</span><span class="p">,</span> <span class="c1"># xaxis label</span>
        <span class="n">yaxis_title_text</span><span class="o">=</span><span class="n">y_label_i</span><span class="p">,</span> <span class="c1"># yaxis label</span>
        <span class="n">bargap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># gap between bars of adjacent location coordinates</span>
        <span class="n">bargroupgap</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># gap between bars of the same location coordinates</span>
    <span class="p">)</span>
    

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;#E3E3E3&#39;</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">hist_int</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;#AB2300&quot;</span><span class="p">,</span> <span class="s2">&quot;Distribution des aliments en fonction de la variable &quot;</span><span class="o">+</span><span class="n">col</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;Fréquence&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous remarquons que la majorité des distributions des variables sont asymétriques vers la gauche, excepté pour la varible energy_100g qui est plus aplatie.</p>
</div>
<div class="section" id="realisons-un-test-de-skewness-pour-confirmer">
<h3>Réalisons un Test de skewness pour confirmer.<a class="headerlink" href="#realisons-un-test-de-skewness-pour-confirmer" title="Permalink to this headline">¶</a></h3>
<p>Pour rappel :</p>
<ul class="simple">
<li><p>Si y1=0 alors la distribution est symétrique.</p></li>
<li><p>Si y1&gt;0 alors la distribution est étalée à droite.</p></li>
<li><p>Si y1&lt;0 alors la distribution est étalée à gauche.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">data_i</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variable : &quot;</span><span class="o">+</span><span class="n">col</span><span class="o">+</span><span class="s2">&quot; ----- y1=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<p>Le test de Skewness confirme ce que nous savons vu grâce au histogramme, les distributions sont étalées à droite.</p>
</div>
<div class="section" id="verifions-comment-nos-variables-se-comportent-par-rapport-a-la-loi-normale-grece-au-test-de-kurtosis">
<h3>Vérifions comment nos variables se comportent par rapport à la loi normale grêce au test de kurtosis.<a class="headerlink" href="#verifions-comment-nos-variables-se-comportent-par-rapport-a-la-loi-normale-grece-au-test-de-kurtosis" title="Permalink to this headline">¶</a></h3>
<p>Si γ2=0 , alors la distribution a le même aplatissement que la distribution normale.</p>
<p>Si γ2&gt;0 , alors elle est moins aplatie que la distribution normale : les observations sont plus concentrées.</p>
<p>Si γ2&lt;0 , alors les observations sont moins concentrées : la distribution est plus aplatie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">data_i</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variable : &quot;</span><span class="o">+</span><span class="n">col</span><span class="o">+</span><span class="s2">&quot; -- y2=&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<p>Nos données sont toutes plus concentrées que la loi normale.</p>
</div>
<div class="section" id="faisons-un-test-pour-verifier-que-nos-distributions-ne-suivent-pas-une-loi-normale">
<h3>Faisons un test pour vérifier que nos distributions ne suivent pas une loi normale.<a class="headerlink" href="#faisons-un-test-pour-verifier-que-nos-distributions-ne-suivent-pas-une-loi-normale" title="Permalink to this headline">¶</a></h3>
<p>Pour rappel, les hypothèse de du test de la loi normal est :</p>
<ul class="simple">
<li><p>h0 = la distribution est normale. (p-value &gt; 0.05)</p></li>
<li><p>h1 = la distribution n’est pas normale. (p-value &lt; 0.05)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">data_i</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variable: &quot;</span><span class="o">+</span><span class="n">col</span><span class="o">+</span><span class="s2">&quot; ----- &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">data_i</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous rejetons H0 pour toutes nos variables, la p-value est inférieure à 0.05.
Nos distributions ne suivent pas une loi normale.</p>
</div>
</div>
<div class="section" id="creons-des-regroupements-afin-que-nos-distributions-soient-mieux-reparties-et-que-nos-variables-soient-plus-pertinentes-pour-la-suite">
<h2>Créons des regroupements afin que nos distributions soient mieux réparties et que nos variables soient plus pertinentes pour la suite.<a class="headerlink" href="#creons-des-regroupements-afin-que-nos-distributions-soient-mieux-reparties-et-que-nos-variables-soient-plus-pertinentes-pour-la-suite" title="Permalink to this headline">¶</a></h2>
<p>Nous appliquerons un système de note en fonction des intervalles :</p>
<ul class="simple">
<li><p>si l’apport nutritionnel fait partie des aliments dit positifs : -6, -4,-2,0,2,4,6,8,10 …Etc</p></li>
<li><p>si l’apport nutritionnel fait partie des aliments dit négatifs : 2,4,6,8,10..Etc</p></li>
</ul>
<div class="section" id="commencons-par-la-variable-additives-n">
<h3>Commençons par la variable additives_n<a class="headerlink" href="#commencons-par-la-variable-additives-n" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;additives_n&quot;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">24</span><span class="p">]</span> <span class="p">,</span><span class="s2">&quot;Distribution des produits en fonction de la variable additives_n&quot;</span><span class="p">,</span>
              <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="s2">&quot;additives_n&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_add</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">6</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">6</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">8</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_additives&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_add</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">additives_n</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_additives&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction des additifs&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="s2">&quot;Intervalle - additives&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Notre distribution est mieux répartie. Conservons ce regroupement.</p>
</div>
<div class="section" id="passons-a-la-variable-energy-100g">
<h3>Passons à la variable energy_100g<a class="headerlink" href="#passons-a-la-variable-energy-100g" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;energy_100g&quot;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">901</span><span class="p">],</span> <span class="s2">&quot;Distribution des produits en fonction de la variable energy_100g&quot;</span><span class="p">,</span><span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">,</span><span class="mi">901</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30000</span> <span class="p">,</span> <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_energy</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">200</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">350</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">350</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">500</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">500</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">700</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">700</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_energy&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_energy</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">energy_100g</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_energy&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction des calories&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;Classe energie&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Notre distribution est mieux répartie.</p>
</div>
<div class="section" id="etudions-la-distribution-de-la-variable-fat-100g">
<h3>Etudions la distribution de la variable fat_100g<a class="headerlink" href="#etudions-la-distribution-de-la-variable-fat-100g" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fat_100g&quot;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s2">&quot;Distribution des produits en fonction de la variable fat_100g&quot;</span><span class="p">,</span>
              <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">65000</span> <span class="p">,</span> <span class="s2">&quot;fat_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_fat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">6</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_fat&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_fat</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">fat_100g</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_fat&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction des matières grasses&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;Classe fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous validons ce regroupement.</p>
</div>
<div class="section" id="passons-a-la-variable-saturated-fat-100g">
<h3>Passons à la variable saturated_fat_100g<a class="headerlink" href="#passons-a-la-variable-saturated-fat-100g" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span> <span class="s2">&quot;Distribution des produits en fonction de la variable fat_100g&quot;</span><span class="p">,</span>
             <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">85000</span> <span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_saturated_fat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">8</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">8</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">40</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">40</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">40</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">90</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_saturated_fat&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_saturated_fat</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">saturated_fat_100g</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_saturated_fat&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction des matières grasses saturées&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="s2">&quot;Note saturated_fat&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous conservons ce regroupement.</p>
</div>
<div class="section" id="etudions-la-variable-carbohydrates-100g">
<h3>Etudions la variable carbohydrates_100g<a class="headerlink" href="#etudions-la-variable-carbohydrates-100g" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> 
              <span class="s2">&quot;Distribution des produits en fonction de la variable carbohydrate_100g&quot;</span><span class="p">,</span>
              <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25000</span> <span class="p">,</span> <span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_carbohydrates</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">5</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">15</span> <span class="ow">and</span>  <span class="n">x</span><span class="o">&lt;</span><span class="mi">25</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">25</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_carbohydrates&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_carbohydrates</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">carbohydrates_100g</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_carbohydrates&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction des carbohydrates&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s2">&quot;Note carbohydrates&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiber_100g&quot;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> 
              <span class="s2">&quot;Distribution des produits en fonction de la variable fiber_100g&quot;</span><span class="p">,</span>
              <span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">45000</span> <span class="p">,</span> <span class="s2">&quot;fiber_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_fiber</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">3</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">5</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">7</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">10</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">7</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">15</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_fiber&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_fiber</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">fiber_100g</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_fiber&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction des fibres&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;Classe fibres&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;proteins_100g&quot;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> 
              <span class="s2">&quot;Distribution des produits en fonction de la variable proteins_100g&quot;</span><span class="p">,</span><span class="s2">&quot;#6D8260&quot;</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80000</span> <span class="p">,</span> <span class="s2">&quot;proteins_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_protein</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">3</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">8</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">4</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">15</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">5</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_protein&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_protein</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">proteins_100g</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_protein&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction des protéines&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;Note protéine&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous utiliserons ce regroupement.</p>
</div>
</div>
<div class="section" id="conclusion-des-variables-quantitatives">
<h2>Conclusion des variables quantitatives<a class="headerlink" href="#conclusion-des-variables-quantitatives" title="Permalink to this headline">¶</a></h2>
<p>Nous avons vu que nos données étaient peu dispersées au sein des variables quantitatives.
Et que les distributions étaient de forme asymétrique vers la gauche.</p>
<p>Nous avons appris que nos aliments étaient assez bien notés au nutriscore fr. En effet, 75% des aliments ont une note inférieure à 5 sachant que le maximum est 41.</p>
<p>Nous avons aussi pu décrire plus précisément les nutriments de nos aliments :</p>
<ul class="simple">
<li><p>50% des aliments apportent plus de 362 calories (energie en calorie)</p></li>
<li><p>75 % des aliments contiennent moins de 5g de matières grasses et moins de 1.60g de matières grasses saturées</p></li>
<li><p>25% des aliments contiennent moins de 4.20g de carbohydrates</p></li>
<li><p>50% des aliments contiennent moins de 3.50g de sucres et moins de 0.46g de sels</p></li>
<li><p>75% des aliments ont moins de 1.90g de fibres et moins de 6.59g de protéines</p></li>
</ul>
<p>Nous avons dans notre base de données des aliments peu calorique, peu gras et peu salé. Mais ils contiennent peu de fibre et peu de protéines.</p>
<p>Regardons à présent ce que peut nous apprendre les variables qualitatives sur notre population.</p>
<div class="section" id="variables-qualitatives">
<h3>Variables qualitatives<a class="headerlink" href="#variables-qualitatives" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nous remarquons que la plupart de nos variables qualitatives comportent beaucoup de catégories et que le mode est “N.A” (non renseigné).
Nous observons aussi que le mode est la modalité B pour le nutriscore Fr et la modalité “NON” pour la variable “ingredients_from_palm_oil”.</p>
<p>Etudions chaque variable pour obtenir plus d’information sur leur répartition.</p>
<div class="section" id="commencons-par-la-variable-product-name">
<h4>Commençons par la variable product_name<a class="headerlink" href="#commencons-par-la-variable-product-name" title="Permalink to this headline">¶</a></h4>
<p>Cette variable contient quasiment autant d’individus que de catégories.</p>
<p>Regardons le top 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Comme nous l’avons remarqué précédemment, nos données sont très dispersées au sein de cette variable.</p>
</div>
<div class="section" id="regardons-la-variable-quantity">
<h4>Regardons la variable quantity<a class="headerlink" href="#regardons-la-variable-quantity" title="Permalink to this headline">¶</a></h4>
<p>Cette variable contient 3906 catégories.</p>
<p>Pour rappel, ces données nous renseigne sur la quantité contenu dans les produits (avec l’unité utilisé)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La modalité “AUTRES” représente 75% des aliments.</p>
<p>Retirons cette modalité et regardons à nouveau le top 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;quantity&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>3.7% des aliments contiennent 300g et 1% des aliments contiennent 600g.</p>
<p>Les données sont très éparpillées au sein des modalités et sont à des échelles différentes. Elle nous apporte pas d’information supplémentaire, nous pouvons la supprimer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="etudions-les-variables-packaging-et-packaging-tags">
<h4>Etudions les variables packaging et packaging_tags<a class="headerlink" href="#etudions-les-variables-packaging-et-packaging-tags" title="Permalink to this headline">¶</a></h4>
<p>La variable packaging contient 4305 catégories et packaging_tag en contient 3592.</p>
<p>Ces variables contiennent aussi beaucoup de catégorie. Etudions les top 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;packaging&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Les données sont très éparpillées au sein des catégories. Et la variable Autres est surreprésentée pour les 2 catégories (78%)
Nous pouvons supprimer ces variables</p>
<p>Excluons la catégorie “AUTRES”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;packaging&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">]</span>
<span class="n">data_autres</span><span class="p">[</span><span class="s2">&quot;packaging&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;packaging_tags&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">]</span>
<span class="n">data_autres</span><span class="p">[</span><span class="s2">&quot;packaging_tags&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Les catégories ne sont pas très pertinentes pour ces deux variables. En effet, nous avons 3% des aliments qui sont dans des conserves et 0.09% des aliments qui sont dans des conserves,métal. Nous pouvons les exclure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;packaging&quot;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;packaging_tags&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;brands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">(</span><span class="n">data_autres</span><span class="p">[</span><span class="s2">&quot;brands&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Créons une fonction qui supprime les variables qui ont un seuil de catégorie important et qui sont très dispersées.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">del_quali_norelevant</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">identifiant</span><span class="p">,</span>  <span class="n">delete_i</span><span class="p">,</span> <span class="n">del_seuilcat_i</span><span class="p">,</span> <span class="n">del_seuilfreq_i</span><span class="p">,</span> <span class="n">all_i</span><span class="p">):</span>
    <span class="n">info</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span> <span class="nb">str</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">identifiant</span><span class="p">:</span>
                <span class="n">data_autres</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">delete_i</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_autres</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">&lt;</span><span class="n">del_seuilfreq_i</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">&gt;</span><span class="n">del_seuilcat_i</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;deleted &quot;</span><span class="o">+</span><span class="n">col</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variable :&quot;</span><span class="o">+</span> <span class="n">col</span> <span class="o">+</span> <span class="s2">&quot;----Max freq :&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">data_autres</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))))</span>      

    
</pre></div>
</div>
</div>
</div>
<p>On supprime les colonnes avec plus de 500 catégorie et dont le maximum de la fréquence d’une modalité est inférieur à 0.05</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">del_quali_norelevant</span><span class="p">(</span><span class="n">data</span><span class="p">,[</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;created_datetime&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span> <span class="s2">&quot;countries&quot;</span><span class="p">,</span> <span class="s2">&quot;countries_tags&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;ingredients_text&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="etudions-la-variable-main-category">
<h4>Etudions la variable main_category<a class="headerlink" href="#etudions-la-variable-main-category" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;main_category&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="p">[</span><span class="s2">&quot;main_category&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_top</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;main_category&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_top</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_cat</span> <span class="o">=</span> <span class="n">data_autres</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;main_category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cat_top</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_bubbleplot</span><span class="p">(</span><span class="n">data_cat</span><span class="p">[</span><span class="s1">&#39;main_category&#39;</span><span class="p">],</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s2">&quot;main_category&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span> 
                 <span class="s2">&quot;Répartition des aliments par catégorie (top 10)&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span>
                    <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La partie Autres est surreprésentée (77%).</p>
<p>Si on exclut la modalité Autres, les données sont très dispersées au sein de cette variable.
Nous avons 8% des aliments qui appartiennent à la catégorie canned-foods  (aliment en conserve) et 2% des aliments sont des boissons et 1.5% des aliments surgelés.</p>
</div>
<div class="section" id="regardons-la-variable-ingredients-text">
<h4>Regardons la variable ingredients_text<a class="headerlink" href="#regardons-la-variable-ingredients-text" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;ingredients_text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Cette variable contient la liste des ingredients contenus dans les aliments.
Il n’est donc pas pertinent de l’étudier</p>
</div>
<div class="section" id="etudions-les-variables-states-states-tags-et-state-fr">
<h4>Etudions les variables states, states_tags et state_fr<a class="headerlink" href="#etudions-les-variables-states-states-tags-et-state-fr" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Ce sont des informations sur l’état de la fiche aliment. Nous pouvons supprimer ces variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;states&quot;</span><span class="p">,</span> <span class="s2">&quot;states_tags&quot;</span><span class="p">,</span> <span class="s2">&quot;states_fr&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="observons-les-variables-additives-tags-et-additives-fr">
<h4>Observons les variables additives_tags et	additives_fr<a class="headerlink" href="#observons-les-variables-additives-tags-et-additives-fr" title="Permalink to this headline">¶</a></h4>
<p>Cette variable comporte 11 748 catégories</p>
<p>Regardons le top 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="p">[</span><span class="s2">&quot;additives_tags&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_autres</span><span class="p">[</span><span class="s2">&quot;additives_fr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La variable “additives_fr” est la “traduction” du code des additifs. Elles ont donc une répartition identiques.</p>
<p>Les données sont très dispersées au sein de ces variables. La catégorie Autres représentent 50% des aliments.</p>
<p>De plus, nous avons une colonne qui contient le nombre d’additifs, et ces colonnes ne sont pas très parlantes.
Nous décidons de les supprimer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;additives_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;additives_tags&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analysons-a-present-la-variable-nutrition-grade-fr">
<h4>Analysons à présent la variable nutrition_grade_fr<a class="headerlink" href="#analysons-a-present-la-variable-nutrition-grade-fr" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nutrition_grade_fr&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des produits selon le nutrition grade&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous observons que nous avons très peu d’aliments de catégorie E (moins de 5%) et de catégorie D (environs 10%)</p>
</div>
<div class="section" id="etudions-la-variable-ingredients-from-palm-oil">
<h4>Etudions la variable ingredients_from_palm_oil<a class="headerlink" href="#etudions-la-variable-ingredients-from-palm-oil" title="Permalink to this headline">¶</a></h4>
<p>Traçons un graphique pour observer la répartition des aliments au sein de cette variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ingredients_from_palm_oil</span><span class="p">,</span> <span class="s2">&quot;freq&quot;</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">t</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">freq</span> <span class="p">,</span> <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">sequential</span><span class="o">.</span><span class="n">RdBu</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Nous remarquons que seulement 0.7% des aliments contiennent potentiellement de l’huile de palme.</p>
</div>
<div class="section" id="passons-aux-variables-pnns-groups-1-et-pnns-groups-2">
<h4>Passons aux variables pnns_groups_1 et pnns_groups_2<a class="headerlink" href="#passons-aux-variables-pnns-groups-1-et-pnns-groups-2" title="Permalink to this headline">¶</a></h4>
<p>Traçons un graphique circulaire pour étudier la répartition des aliments au sein de ces variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">sunburst</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pnns_groups_1&#39;</span><span class="p">,</span> <span class="s1">&#39;pnns_groups_2&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Excluons la catégorie “Autres” qui représente 57% des aliments et renommons la catégorie “Unknown” en “AUTRES”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pnns_groups_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pnns_groups_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pnns_groups_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="s1">&#39;AUTRES&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;pnns_groups_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pnns_groups_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="s1">&#39;AUTRES&#39;</span><span class="p">)</span>
<span class="n">data_autres</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">pnns_groups_1</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">pnns_groups_2</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">)</span> <span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">sunburst</span><span class="p">(</span><span class="n">data_autres</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pnns_groups_1&#39;</span><span class="p">,</span> <span class="s1">&#39;pnns_groups_2&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Nous remarquons que la plupart des aliments sont des boissons et des ingredients.</p>
</div>
<div class="section" id="decrivons-nos-donnees-en-regardons-le-nombre-d-aliments-par-date-de-creation-des-fiches">
<h4>Décrivons nos données en regardons le nombre d’aliments par date de création des fiches.<a class="headerlink" href="#decrivons-nos-donnees-en-regardons-le-nombre-d-aliments-par-date-de-creation-des-fiches" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;created_datetime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">year</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;created_datetime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">month</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;year_month&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;created_datetime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y/%m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_month</span><span class="o">=</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_month</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_month</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">animation_frame</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">animation_group</span><span class="o">=</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> 
           <span class="n">log_x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size_max</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>

<span class="n">fig</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;updatemenus&quot;</span><span class="p">)</span> <span class="c1"># optional, drop animation buttons</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Nous remarquons que la plupart de nos données ont été créées en mars 2017.</p>
</div>
<div class="section" id="regardons-d-ou-provient-la-majorite-des-aliments-grace-a-la-variable-countries">
<h4>Regardons d’où provient la majorité des aliments grâce à la variable countries.<a class="headerlink" href="#regardons-d-ou-provient-la-majorite-des-aliments-grace-a-la-variable-countries" title="Permalink to this headline">¶</a></h4>
<p>Nous avons besoin d’importer les pays et leur code iso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_countries</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">&quot;.\data\countries.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_countries</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_countries</span><span class="o">=</span><span class="n">pk</span><span class="o">.</span><span class="n">data_majuscule</span><span class="p">(</span><span class="n">info_countries</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_countries</span> <span class="o">=</span> <span class="n">info_countries</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;countries_tags&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">countries_tags</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">countries_tags</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">countries_tags</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;EN:&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">countries_tags</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">countries_tags</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;UNITED-STATES&quot;</span><span class="p">,</span><span class="s2">&quot;UNITED STATES OF AMERICA&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">countries_tags</span>
</pre></div>
</div>
</div>
</div>
<p>!nous pouvons à présent ajouter lke code iso dans notre base de données.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">info_countries</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;countries_tags&quot;</span><span class="p">],</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;_del&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_merge</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_merge</span><span class="o">.</span><span class="n">alpha3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_result</span> <span class="o">=</span> <span class="n">data_merge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_merge</span><span class="p">[</span><span class="s2">&quot;_merge&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_merge&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data_result</span> <span class="o">=</span> <span class="n">data_result</span><span class="p">[[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data_result</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="o">|</span><span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;alpha2&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">c</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_del&#39;</span><span class="p">)</span> <span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_result</span><span class="o">.</span><span class="n">alpha3</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span> <span class="n">data_result</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">alpha3</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maptest</span><span class="o">=</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;alpha3&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;countries_tags&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maptest</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_geo</span><span class="p">(</span><span class="n">maptest</span><span class="p">,</span> <span class="n">locations</span><span class="o">=</span><span class="s2">&quot;alpha3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span>
                     <span class="n">hover_name</span><span class="o">=</span><span class="s2">&quot;countries_tags&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
                     <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;natural earth&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>La majorité de nos aliments proviennent des USA.</p>
</div>
<div class="section" id="id1">
<h4>Analysons à présent la variable nutrition_grade_fr<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nutrition_grade_fr&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des produits selon le nutrition grade&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous observons que nous avons très peu d’aliments de catégorie E (moins de 5%) et de catégorie D (environs 10%)</p>
</div>
</div>
</div>
<div class="section" id="conclusion-qualitatives">
<h2>Conclusion qualitatives<a class="headerlink" href="#conclusion-qualitatives" title="Permalink to this headline">¶</a></h2>
<p>Nous avons appris que les variables qualitatives étaient très disperséesau sein des catégories et que la majorité des aliments étaient dans la catégorie “AUTRES”.</p>
<p>Nous avons aussi remarqué que nos données ont été créées en mars 2017 et que les aliments proviennent des USA.
Nous savons aussi que nos aliments sont bien notés, 32% des aliments ont un B et 28% des aliments ont un A contre moins de 5% des aliments ont un E.</p>
<p>Maintenant que nous connaissons nos données. Il est important de pouvoir faire un zoom sur le nutriscore afin d’améliorer la santé des français.</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="est-ce-que-le-nutriscore-contribue-a-ameliorer-la-sante-des-francais-dans-ce-but-est-ce-que-le-nutriscore-permet-de-manger-equilibrer">
<h1>Est-ce que le nutriscore contribue à améliorer la santé des français ? Dans ce but, est ce que le nutriscore permet de manger équilibrer ?<a class="headerlink" href="#est-ce-que-le-nutriscore-contribue-a-ameliorer-la-sante-des-francais-dans-ce-but-est-ce-que-le-nutriscore-permet-de-manger-equilibrer" title="Permalink to this headline">¶</a></h1>
<div class="section" id="nos-variables">
<h2>Nos variables<a class="headerlink" href="#nos-variables" title="Permalink to this headline">¶</a></h2>
<p>Nous allons commencer par sélectionner les colonnes qu’il nous faut pour améliorer la santé des français.</p>
<p>Certains organismes officiels, comme l’AFSSA (Agence française de sécurité sanitaire des aliments), ont crée des recommandations sous forme d’apports nutritionnels conseillés (ANC) pour chaque type de nutriment.</p>
<p>source : <a class="reference external" href="https://www.vidal.fr/sante/nutrition/equilibre-alimentaire-adulte/recommandations-nutritionnelles-adulte/en-pratique.html">https://www.vidal.fr/sante/nutrition/equilibre-alimentaire-adulte/recommandations-nutritionnelles-adulte/en-pratique.html</a></p>
<p>Selon le tableau nutritionnel, voici les informations dont nous avons besoin : Glucides, Lipides, Protéines, Fibres. Et les aliments qui contiennent de l’huile de palme sont à notifier.</p>
<p>Comment le Nutri-Score Fr est-il calculé?</p>
<p>Points négatifs : l’énergie, les graisses saturées, les sucres, et le sel (des niveaux élevés sont considérés comme mauvais pour la santé)</p>
<p>Points positifs : la proportion de fruits, de légumes, de noix, d’huiles d’olive, de colza et de noix, de fibres et de protéines (les niveaux élevés sont considérés comme bons pour la santé).</p>
<p>Sélectionnons donc seulement les colonnes nécessaires à notre étude. Nous sélectionnons tous les aliments même ceux qui ne sont pas vendu en France. En effet, ils peuvent être vendus prochainement et être interessant pour notre étude.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span>  
            <span class="s2">&quot;ingredients_text&quot;</span><span class="p">,</span><span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;proteins_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fat_100g&quot;</span><span class="p">,</span>
            <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fiber_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;salt_100g&quot;</span><span class="p">,</span>
             <span class="s2">&quot;additives_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_from_palm_oil&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;main_category&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;reg_additives&#39;</span><span class="p">,</span>
       <span class="s1">&#39;reg_energy&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_fat&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_carbohydrates&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_fiber&#39;</span><span class="p">,</span> 
       <span class="s1">&#39;reg_protein&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="quels-sont-ses-caracteristiques">
<h2>Quels sont ses caractéristiques ?<a class="headerlink" href="#quels-sont-ses-caracteristiques" title="Permalink to this headline">¶</a></h2>
<div class="section" id="techniquement-voici-les-elements-qui-agit-sur-le-nutriscore">
<h3>Techniquement, voici les éléments qui agit sur le nutriscore :<a class="headerlink" href="#techniquement-voici-les-elements-qui-agit-sur-le-nutriscore" title="Permalink to this headline">¶</a></h3>
<p>Points négatifs : l’énergie, les graisses saturées, les sucres, et le sel (des niveaux élevés sont considérés comme mauvais pour la santé)</p>
<p>Points positifs : la proportion de fruits, de légumes, de noix, d’huiles d’olive, de colza et de noix, de fibres et de protéines (les niveaux élevés sont considérés comme bons pour la santé).</p>
</div>
</div>
<div class="section" id="est-ce-que-si-nous-mangeons-que-des-aliments-avec-un-nutriscore-a-serons-nous-en-bonne-sante">
<h2>Est - ce que si nous mangeons que des aliments avec un nutriscore A, serons - nous en bonne santé ?<a class="headerlink" href="#est-ce-que-si-nous-mangeons-que-des-aliments-avec-un-nutriscore-a-serons-nous-en-bonne-sante" title="Permalink to this headline">¶</a></h2>
<div class="section" id="comparons-les-informations-des-differentes-notes">
<h3>Comparons les informations  des différentes notes.<a class="headerlink" href="#comparons-les-informations-des-differentes-notes" title="Permalink to this headline">¶</a></h3>
<p>Excluons les données non renseignées du Nutriscore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataN</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;AUTRES&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analyse-bivariee-etudions-le-lien-entre-la-variable-nutrition-grade-fr-et-les-autres-variables">
<h3>Analyse bivariée : Etudions le lien entre la variable nutrition_grade_fr et les autres variables.<a class="headerlink" href="#analyse-bivariee-etudions-le-lien-entre-la-variable-nutrition-grade-fr-et-les-autres-variables" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataN</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">percentile</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">percentile_</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">percentile_</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="s1">&#39;percentile_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">percentile_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data_study</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dataN</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">percentile</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="n">percentile</span><span class="p">(</span><span class="mi">75</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data_study</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;moyenne &quot;</span><span class="o">+</span><span class="n">col</span> <span class="o">+</span><span class="s2">&quot; = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dataN</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
    <span class="n">pk</span><span class="o">.</span><span class="n">graph_boxplot_by_group</span><span class="p">(</span><span class="n">dataN</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;Boite à moustache de la variable &quot;</span><span class="o">+</span><span class="n">col</span><span class="o">+</span><span class="s2">&quot; en fonction du nutriscore&quot;</span><span class="p">,</span> <span class="s2">&quot;rocket_r&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Grâce à ces boites à moustache, nous remarquons qu’ils restent des données extrêmes. Mais dans ce contexte, nous devons les conserver pour ne pas perdre d’information.</p>
<p>Les boites à moustache sont peu dispersées même si en fonction des notes, leur dispersion peuvent plus ou moins varié.</p>
<p>Comment pouvons - nous décrire les aliments avec une note A ?</p>
<ul class="simple">
<li><p>riches en fibres et en proteines</p></li>
<li><p>peu de sel, de sucre et de matières grasses (y compris en graisses saturés)</p></li>
<li><p>contiennent des fruits, végétaux ou des arachides</p></li>
<li><p>faible en additifs</p></li>
<li><p>apport en energie proche de la moyenne</p></li>
</ul>
<p>Comment pouvons - nous décrire les aliments avec une note E ?</p>
<ul class="simple">
<li><p>riches en sucre, en additif et en glucides</p></li>
<li><p>pauvres en fibres, proteines, sel</p></li>
<li><p>une energie qui varie beaucoup dans les extrêmes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataN</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s2">&quot;ingredients_from_palm_oil&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dataN</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Les produits qui contiennent potentiellement de l’huile de palme ont les meilleurs notes.</p>
</div>
<div class="section" id="confirmons-nos-resultats-precedents-en-verifiant-le-lien-entre-nos-variables-quantitatives-et-le-grade-du-nutriscore">
<h3>Confirmons nos résultats précédents en vérifiant le lien entre nos variables quantitatives et le grade du nutriscore<a class="headerlink" href="#confirmons-nos-resultats-precedents-en-verifiant-le-lien-entre-nos-variables-quantitatives-et-le-grade-du-nutriscore" title="Permalink to this headline">¶</a></h3>
<p>Pour cela, nous pourrions modéliser nos données en réalisant une ANOVA.
Mais cela suppose 3 choses :</p>
<ul class="simple">
<li><p>l’indépendance entre chaque groupe</p></li>
<li><p>l’égalité des variances</p></li>
<li><p>la normalité des résidus (cela permet de ne pas affirmer qu’il existe une différence de moyenne entre les groupes qui serait causée par le hasard).</p></li>
</ul>
</div>
<div class="section" id="l-independance-entre-nos-groupes">
<h3>L’indépendance entre nos groupes<a class="headerlink" href="#l-independance-entre-nos-groupes" title="Permalink to this headline">¶</a></h3>
<p>Selon le contexte, nous savons que chaque lettre du nutriscore est indépendante car elle représente un classement des aliments.</p>
</div>
<div class="section" id="l-egalite-des-variances">
<h3>L’égalité des variances<a class="headerlink" href="#l-egalite-des-variances" title="Permalink to this headline">¶</a></h3>
<p>Réalisons un test de bartlette afin de confirmer ce que nous avons vu lors de l’analyse bivariée.</p>
<p>H0 : Les variances de chaque groupe sont égales si p-value &gt; 5%</p>
<p>H1 : Les variances de chaque groupe ne sont pas toutes égales &lt; 5%</p>
<p>Définissons nos groupes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_a</span><span class="o">=</span><span class="n">dataN</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="n">data_b</span><span class="o">=</span><span class="n">dataN</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>
<span class="n">data_c</span><span class="o">=</span><span class="n">dataN</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="n">data_d</span><span class="o">=</span><span class="n">dataN</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;D&quot;</span><span class="p">]</span>
<span class="n">data_e</span><span class="o">=</span><span class="n">dataN</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;E&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Effectuons le test pour chaque variable quantitative</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataN</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;colonne &quot;</span><span class="o">+</span><span class="n">col</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">bartlett</span><span class="p">(</span><span class="n">data_a</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">data_b</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">data_c</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">data_d</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">data_e</span><span class="p">[</span><span class="n">col</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<p>Nous rejetons h0 pour toutes nos variables. Les variances ne sont pas égales.</p>
<p>La deuxième condition pour effectuer une ANOVA n’est pas validée.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;energy_100g ~ nutrition_grade_fr &#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataN</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">anova</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">anova_lm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">anova</span>
</pre></div>
</div>
</div>
</div>
<p>H0 : les moyennes sont équivalent dans les groupes
H1 : les moyennes sont différentes</p>
<p>P&lt;0.05 on rejette H0. et on admet H1.</p>
<div class="section" id="les-residus-doivent-suivre-une-loi-normale">
<h4>Les résidus doivent suivre une loi normale<a class="headerlink" href="#les-residus-doivent-suivre-une-loi-normale" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;energy_100g ~ nutrition_grade_fr&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataN</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>~H0 : Les résidus suivent une loi normale si p-value &gt; 5%~
H1 : Les résidus ne suivent pas une loi normale si p-value &lt; 5%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;energy_100g ~ nutrition_grade_fr&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataN</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>


<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="utilisons-le-test-de-krusdall-utilise-les-rangs-au-lieu-des-moyennes">
<h3>Utilisons le test de Krusdall (utilise les rangs au lieu des moyennes)<a class="headerlink" href="#utilisons-le-test-de-krusdall-utilise-les-rangs-au-lieu-des-moyennes" title="Permalink to this headline">¶</a></h3>
<p>H0 :  la médiane de la population de tous les groupes est égale
H1 :  la médiane de la population d’au moins un groupe n’est pas égale</p>
<p>Test Krusdall(utilise mediane et quantile)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;colonne &quot;</span><span class="o">+</span><span class="n">col</span><span class="o">+</span><span class="s2">&quot;: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">kruskal</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">group</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">dataN</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)])))</span>
</pre></div>
</div>
</div>
</div>
<p>Signatifivement différent on rejette H0 car pvalue&lt;5%</p>
<p>Selon le test, la mediane d’un groupe sont significativement différents pour chacunes des variables.</p>
</div>
</div>
<div class="section" id="conclusion-nutriscore">
<h2>Conclusion Nutriscore<a class="headerlink" href="#conclusion-nutriscore" title="Permalink to this headline">¶</a></h2>
<p>les aliments avec une note A ?</p>
<ul class="simple">
<li><p>riches en fibres et en proteines</p></li>
<li><p>peu de sel, de sucre et de matières grasses (y compris en graisses saturés)</p></li>
<li><p>contiennent des fruits, végétaux ou des arachides</p></li>
<li><p>faible en additifs</p></li>
<li><p>apport en energie proche de la moyenne</p></li>
</ul>
<p>les aliments avec une note E ?</p>
<ul class="simple">
<li><p>riches en sucre, en additif et en glucides</p></li>
<li><p>pauvres en fibres, proteines, sel</p></li>
<li><p>une energie qui varie beaucoup dans les extrêmes.</p></li>
</ul>
<p>Cependant, nous avons besoin d’une alimentation équilibrée.</p>
<p>Voici l’apport quotidien pour un adulte :</p>
<p>Glucides = 250g (carbohydrates)</p>
<p>lipides = 50 insaturé et 20 sature</p>
<p>Protéines =	45 g pour une personne de 55 kg
60 g pour une personne de 75 kg</p>
<p>Fibres =	25 à 30 g dont une moitié issue des céréales et l’autre issue des fruits et légumes</p>
<p>Donc si nous mangeons que des produits A, cela ne nous permet pas de manger équilibrer et ne permet pas d’améliorer la santé.
Comment pouvons - nous améliorer la santé des français?</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="objectif-une-meilleure-sante-pour-tous-application-smart-food">
<h1>Objectif une meilleure santé pour tous : Application Smart Food<a class="headerlink" href="#objectif-une-meilleure-sante-pour-tous-application-smart-food" title="Permalink to this headline">¶</a></h1>
<p>Un classement des aliments et le calcul de leur combinaison permettront d’améliorer la santé des français et les guider vers une alimentation équilibrée sans se priver.</p>
<div class="section" id="classement-des-aliments">
<h2>Classement des aliments<a class="headerlink" href="#classement-des-aliments" title="Permalink to this headline">¶</a></h2>
<p>Etudions de plus près nos aliments et regardons qu’elles sont les variables qui permettent d’expliquer au mieux cette population.</p>
<p>Pour commencer, il nous faut exclure les données manquantes et étudier les variables quantitatives qui sont corrélées.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<p>Regardons les variables corrélées.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)})</span>

<span class="n">data_corr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data_corr</span><span class="p">,</span> <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">data_corr</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> 
                 <span class="n">yticklabels</span> <span class="o">=</span> <span class="n">data_corr</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_acp</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">energy_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">carbohydrates_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">proteins_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">fat_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
       <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiber_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                 <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                 <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;additives_n&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Nous excluons la variable sugars_100 car elle est corrélée avec carbohydrates_100g (glucides).
Et nous excluons la variable satured_fat qui est corrélée avec fat_100g.
Nous excluons aussi la variable energy_100g qui est corrélé avec fat_100g.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">scale</span>
<span class="c1"># suppression des colonnes non numériques</span>
<span class="n">WGI_num0</span> <span class="o">=</span> <span class="n">data_acp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span> <span class="o">=</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;reg_additives&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fat&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_saturated_fat&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_carbohydrates&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fiber&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;reg_protein&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span><span class="s2">&quot;nutrition-score-uk_100g&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sodium_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sugars_100g&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">WGI_num</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">))</span>

<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">WGI_num</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Dimension&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dim&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)],</span> 
        <span class="s2">&quot;Variance expliquée&quot;</span> <span class="p">:</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">,</span>
        <span class="s2">&quot;% variance expliquée&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;</span><span class="si">% c</span><span class="s2">um. var. expliquée&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">eig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Dimension&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;% variance expliquée&quot;</span><span class="p">)</span> <span class="c1"># permet un diagramme en barres</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="s2">&quot;14%&quot;</span><span class="p">)</span> <span class="c1"># ajout de texte</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;dimgray&quot;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span> <span class="c1"># ligne 17 = 100 / 6 (nb dimensions)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">WGI_num</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transformation en DataFrame pandas</span>
<span class="n">WGI_pca_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Dim1&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
    <span class="s2">&quot;Dim2&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;Dim3&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
    <span class="s2">&quot;Dim4&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span>
    <span class="s2">&quot;Dim5&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">4</span><span class="p">],</span>
    <span class="s2">&quot;Dim6&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">5</span><span class="p">],</span>
    <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="n">data_acp</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">],</span>
    <span class="s2">&quot;nutrition_grade_fr&quot;</span> <span class="p">:</span> <span class="n">data_acp</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Résultat (premières lignes)</span>
<span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s2">&quot;Dim1&quot;</span><span class="p">,</span> <span class="s2">&quot;Dim2&quot;</span><span class="p">)</span> <span class="c1"># nuage de points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Dimension 1 (35%)&quot;</span><span class="p">)</span> <span class="c1"># modification du nom de l&#39;axe X</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dimension 2 (30%)&quot;</span><span class="p">)</span> <span class="c1"># idem pour axe Y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Premier plan factoriel (65%)&quot;</span><span class="p">)</span> <span class="c1"># titre général</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">WGI_num</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># nb individus</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">WGI_num</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># nb variables</span>
<span class="n">eigval</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span> <span class="c1"># valeurs propres</span>
<span class="n">sqrt_eigval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span> <span class="c1"># racine carrée des valeurs propres</span>
<span class="n">corvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span> <span class="c1"># matrice vide pour avoir les coordonnées</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">corvar</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">sqrt_eigval</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="c1"># on modifie pour avoir un dataframe</span>
<span class="n">coordvar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;COR_1&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;COR_2&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;COR_3&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
                        <span class="p">,</span> <span class="s1">&#39;COR_4&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;COR_5&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;COR_6&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]})</span>
<span class="n">coordvar</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yellowbrick.datasets</span> <span class="kn">import</span> <span class="n">load_concrete</span>
<span class="kn">from</span> <span class="nn">yellowbrick.features</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">yellowbrick.style</span> <span class="kn">import</span> <span class="n">set_palette</span>

<span class="c1"># Load the concrete dataset</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">proj_features</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">xs</span><span class="o">=</span><span class="n">WGI_pca_df</span><span class="p">[</span><span class="s2">&quot;Dim1&quot;</span><span class="p">],</span> 
    <span class="n">ys</span><span class="o">=</span><span class="n">WGI_pca_df</span><span class="p">[</span><span class="s2">&quot;Dim2&quot;</span><span class="p">],</span> 
    <span class="n">zs</span><span class="o">=</span><span class="n">WGI_pca_df</span><span class="p">[</span><span class="s2">&quot;Dim3&quot;</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Dim 1 (35%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Dim 2 (30%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Dim 3 (21%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_a</span><span class="o">=</span><span class="n">data_acp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_acp</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_b</span><span class="o">=</span><span class="n">data_acp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_acp</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_c</span><span class="o">=</span><span class="n">data_acp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_acp</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_d</span><span class="o">=</span><span class="n">data_acp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_acp</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;D&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_e</span><span class="o">=</span><span class="n">data_acp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_acp</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_a</span><span class="p">,</span> <span class="n">test_b</span><span class="p">,</span> <span class="n">test_c</span><span class="p">,</span> <span class="n">test_d</span><span class="p">,</span> <span class="n">test_e</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="n">data_acp</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span> <span class="o">=</span> <span class="n">test2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;reg_additives&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fat&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_saturated_fat&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_carbohydrates&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fiber&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;reg_protein&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span><span class="s2">&quot;nutrition-score-uk_100g&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sodium_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sugars_100g&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#librairies pour la CAH</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="c1">#générer la matrice des liens</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
<span class="c1">#affichage du dendrogramme</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;CAH&quot;</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">test2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">color_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Noous décidons de couper  groupes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">kmeans2</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">kmeans2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_k2</span> <span class="o">=</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">WGI_k2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;classe&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_k2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Dim1&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Dim2&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Accent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">xs</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim1&quot;</span><span class="p">],</span> 
    <span class="n">ys</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim2&quot;</span><span class="p">],</span> 
    <span class="n">zs</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim3&quot;</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;classe&quot;</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Dim 1 (35%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Dim 2(30%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Dim 3 (21%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
    <span class="n">inertia</span> <span class="o">=</span> <span class="n">inertia</span> <span class="o">+</span> <span class="p">[</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">]</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="s2">&quot;inertia&quot;</span><span class="p">:</span> <span class="n">inertia</span><span class="p">})</span>
<span class="n">inertia</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;inertia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">inertia</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;k == 2&#39;</span><span class="p">)[</span><span class="s2">&quot;inertia&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">inertia</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;k == 4&#39;</span><span class="p">)[</span><span class="s2">&quot;inertia&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>coude plus marqué au niveau du 4</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span>
</pre></div>
</div>
</div>
</div>
<p>Ces 4 classes vont permettre de manger équilibrer en les combinant.</p>
<p>Comparons les nouveaux groupes et le nutriscore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">nutrition_grade_fr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">tm</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tm</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Aucun groupe ne semble se demarquer, excepté la classe 2.</p>
<p>Les autres groupes sont homogènes. Ce découpage ne semble pas adapter et est assez aléatoire.</p>
</div>
<div class="section" id="utilisation-des-variables-quantitatives-contenant-les-notes">
<h2>Utilisation des variables quantitatives contenant les notes<a class="headerlink" href="#utilisation-des-variables-quantitatives-contenant-les-notes" title="Permalink to this headline">¶</a></h2>
<p>Essayons de refaire les calculs avec nos variables “regroupement”</p>
<p>Nous pouvons créer un score total qui ajoutera un poids en fonction des nutriments positifs et négatifs établis par l’agence du nutriscore.</p>
<p>Pour rappel :</p>
<ul class="simple">
<li><p>Points négatifs : l’énergie, les graisses saturées, les sucres, et le sel (des niveaux élevés sont considérés comme mauvais pour la santé)</p></li>
<li><p>Points positifs : la proportion de fruits, de légumes, de noix, d’huiles d’olive, de colza et de noix, de fibres et de protéines (les niveaux élevés sont considérés comme bons pour la santé).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;score_total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reg_saturated_fat</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sugars_100g&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;salt_100g&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_additives&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_energy&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_fat&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_carbohydrates&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_fiber&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_protein&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;score_total&quot;</span><span class="p">],[</span><span class="o">-</span><span class="mi">28</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">250</span><span class="p">]</span> <span class="p">,</span><span class="s2">&quot;Distribution des produits en fonction de la variable score_total&quot;</span><span class="p">,(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
          <span class="o">-</span><span class="mi">28</span><span class="p">,</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="s2">&quot;score_total&quot;</span><span class="p">,</span> <span class="s1">&#39;Fréquences&#39;</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Réalisons un regroupement et appliquons des notes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reg_score_total</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">&lt;-</span><span class="mi">10</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">10</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=-</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;-</span><span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=-</span><span class="mi">5</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">5</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">15</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">15</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">25</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">20</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">25</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">50</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">50</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">50</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">80</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">80</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">80</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">200</span>
    <span class="k">elif</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">300</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_score_total&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">reg_score_total</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">score_total</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pk</span><span class="o">.</span><span class="n">graph_barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;reg_score_total&#39;</span><span class="p">],</span> <span class="s2">&quot;Répartition des aliments en fonction du score total&quot;</span><span class="p">,</span> 
              <span class="p">(</span><span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">),</span>
              <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;Classe proteine&quot;</span><span class="p">,</span> <span class="s2">&quot;Fréquence en %&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,(</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span>  <span class="s2">&quot;score_total&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ingredients_text&quot;</span><span class="p">,</span><span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;proteins_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fat_100g&quot;</span><span class="p">,</span>
            <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fiber_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;salt_100g&quot;</span><span class="p">,</span>
             <span class="s2">&quot;additives_n&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;main_category&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;reg_additives&#39;</span><span class="p">,</span>
       <span class="s1">&#39;reg_energy&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_fat&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_carbohydrates&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_fiber&#39;</span><span class="p">,</span> <span class="s2">&quot;reg_score_total&quot;</span><span class="p">,</span>
       <span class="s1">&#39;reg_protein&#39;</span><span class="p">]]</span>
<span class="n">data_study</span><span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_additives</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_energy</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> 
               <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_carbohydrates</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_fat</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> 
               <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_fiber</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">score_total</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                            <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">nutrition_score_fr_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                          <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_protein</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">scale</span>
<span class="c1"># suppression des colonnes non numériques</span>
<span class="n">WGI_num0</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;main_category&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span><span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span><span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;proteins_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fiber_100g&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;additives_n&quot;</span><span class="p">,</span><span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;product_name&quot;</span><span class="p">,</span><span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span><span class="s2">&quot;code&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;ingredients_text&quot;</span><span class="p">,</span>  <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">])</span>

<span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span>

<span class="n">WGI_num0</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">WGI_num</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">))</span>

<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">WGI_num</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Dimension&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dim&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)],</span> 
        <span class="s2">&quot;Variance expliquée&quot;</span> <span class="p">:</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">,</span>
        <span class="s2">&quot;% variance expliquée&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;</span><span class="si">% c</span><span class="s2">um. var. expliquée&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">eig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Dimension&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;% variance expliquée&quot;</span><span class="p">)</span> <span class="c1"># permet un diagramme en barres</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="s2">&quot;14%&quot;</span><span class="p">)</span> <span class="c1"># ajout de texte</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;dimgray&quot;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span> <span class="c1"># ligne 17 = 100 / 6 (nb dimensions)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">WGI_num</span><span class="p">)</span>

<span class="c1"># +</span>
<span class="c1"># Transformation en DataFrame pandas</span>
<span class="n">WGI_pca_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Dim1&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
    <span class="s2">&quot;Dim2&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;Dim3&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
    <span class="s2">&quot;Dim4&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span>
    <span class="s2">&quot;Dim5&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">4</span><span class="p">],</span>
    <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">],</span>
    <span class="s2">&quot;nutrition_grade_fr&quot;</span> <span class="p">:</span> <span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span>
<span class="p">})</span>
<span class="c1"># Résultat (premières lignes)</span>
<span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s2">&quot;Dim1&quot;</span><span class="p">,</span> <span class="s2">&quot;Dim2&quot;</span><span class="p">,</span> <span class="s2">&quot;Dim3&quot;</span><span class="p">)</span> <span class="c1"># nuage de points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Dimension 1 (35%)&quot;</span><span class="p">)</span> <span class="c1"># modification du nom de l&#39;axe X</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dimension 2 (30%)&quot;</span><span class="p">)</span> <span class="c1"># idem pour axe Y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Premier plan factoriel (65%)&quot;</span><span class="p">)</span> <span class="c1"># titre général</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yellowbrick.datasets</span> <span class="kn">import</span> <span class="n">load_concrete</span>
<span class="kn">from</span> <span class="nn">yellowbrick.features</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">yellowbrick.style</span> <span class="kn">import</span> <span class="n">set_palette</span>

<span class="c1"># Load the concrete dataset</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">proj_features</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num</span><span class="o">.</span><span class="n">shape</span>

<span class="n">WGI_num</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -</span>


<span class="n">n</span> <span class="o">=</span> <span class="n">WGI_num</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># nb individus</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">WGI_num</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># nb variables</span>
<span class="n">eigval</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span> <span class="c1"># valeurs propres</span>
<span class="n">sqrt_eigval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span> <span class="c1"># racine carrée des valeurs propres</span>
<span class="n">corvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span> <span class="c1"># matrice vide pour avoir les coordonnées</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">corvar</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">sqrt_eigval</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="c1"># on modifie pour avoir un dataframe</span>
<span class="n">coordvar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;COR_1&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;COR_2&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;COR_3&#39;</span><span class="p">:</span> <span class="n">corvar</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
                        <span class="p">})</span>
<span class="n">coordvar</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num_t2</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span><span class="s2">&quot;main_category&quot;</span><span class="p">,</span> 
                                      <span class="s2">&quot;product_name&quot;</span><span class="p">,</span><span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> 
                                      <span class="s2">&quot;ingredients_text&quot;</span><span class="p">,</span><span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span><span class="s2">&quot;reg_additives&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;proteins_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fat_100g&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;fiber_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;salt_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;additives_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">])</span>

<span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_a</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_b</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_c</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_d</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;D&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_e</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">472</span><span class="p">)</span>

<span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_a</span><span class="p">,</span> <span class="n">test_b</span><span class="p">,</span> <span class="n">test_c</span><span class="p">,</span> <span class="n">test_d</span><span class="p">,</span> <span class="n">test_e</span><span class="p">]</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">test</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#librairies pour la CAH</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="c1">#générer la matrice des liens</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
<span class="c1">#affichage du dendrogramme</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;CAH&quot;</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">color_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">kmeans2</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">kmeans2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_k2</span> <span class="o">=</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">WGI_k2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;classe&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">WGI_k2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Dim1&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Dim2&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Accent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">xs</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim1&quot;</span><span class="p">],</span> 
    <span class="n">ys</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim2&quot;</span><span class="p">],</span> 
    <span class="n">zs</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim3&quot;</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;classe&quot;</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Dim 1 (35%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Dim 2(30%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Dim 3 (21%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
    <span class="n">inertia</span> <span class="o">=</span> <span class="n">inertia</span> <span class="o">+</span> <span class="p">[</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">]</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="s2">&quot;inertia&quot;</span><span class="p">:</span> <span class="n">inertia</span><span class="p">})</span>
<span class="n">inertia</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;inertia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">inertia</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;k == 2&#39;</span><span class="p">)[</span><span class="s2">&quot;inertia&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">inertia</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;k == 5&#39;</span><span class="p">)[</span><span class="s2">&quot;inertia&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">nutrition_grade_fr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">tm</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tm</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_class</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_class</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Ces résultats sont assez proche du nutriscore. Il y a des poids à mettre en fonction des apports nutritionnels.
Il faut donc appliquer une règle métier.</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="combinaison-des-aliments">
<h1>Combinaison des aliments<a class="headerlink" href="#combinaison-des-aliments" title="Permalink to this headline">¶</a></h1>
<p>Voici l’apport quotidien pour un adulte :</p>
<p>Glucides = 250g (carbohydrates)</p>
<p>lipides = 50 insaturé et 20 sature</p>
<p>Protéines = 45 g pour une personne de 55 kg 60 g pour une personne de 75 kg</p>
<p>Fibres = 25 à 30 g dont une moitié issue des céréales et l’autre issue des fruits et légumes</p>
<p>Mise à disposition d’une application Smart-Food.</p>
<p>Mise au panier d’aliment et calcul de l’apport quotidien Vert/rouge.</p>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "venv"
        },
        kernelOptions: {
            kernelName: "venv",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'venv'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome to your Jupyter Book</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          Par The Jupyter Book Community<br/>
        
            &copy; droits d'auteur 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>