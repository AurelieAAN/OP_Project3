
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IV - Objectif une meilleure santé pour tous : Application Smart Food &#8212; Améliorer la santé des français</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="V - Combinaison des aliments" href="ScriptFood_Analyse_p5.html" />
    <link rel="prev" title="III - Est-ce que le nutriscore contribue à améliorer la santé des français ? Dans ce but, est ce que le nutriscore permet de manger équilibrer ?" href="ScriptFood_Analyse_p3.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.bmp" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Améliorer la santé des français</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Rechercher dans ce livre ..." aria-label="Rechercher dans ce livre ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Objectif : Améliorer la santé des français book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ScriptFood_Analyse_p1.html">
   I - Contexte du projet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ScriptFood_Analyse_p2.html">
   II - Présentation de la base de données
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ScriptFood_Analyse_p3.html">
   III - Est-ce que le nutriscore contribue à améliorer la santé des français ? Dans ce but, est ce que le nutriscore permet de manger équilibrer ?
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   IV - Objectif une meilleure santé pour tous : Application Smart Food
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ScriptFood_Analyse_p5.html">
   V - Combinaison des aliments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ScriptFood_Analyse_p6.html">
   Conclusion - Un Apport journalier équilibré
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Basculer la navigation" aria-controls="site-navigation"
                title="Basculer la navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Téléchargez cette page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/ScriptFood_Analyse_p4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Télécharger le fichier source" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimer au format PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/AurelieAAN/OP_Project3"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Dépôt source"><i
                    class="fab fa-github"></i>dépôt</button></a>
        <a class="issues-button"
            href="https://github.com/AurelieAAN/OP_Project3/issues/new?title=Issue%20on%20page%20%2FScriptFood_Analyse_p4.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Ouvrez un problème"><i class="fas fa-lightbulb"></i>signaler un problème</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Mode plein écran"
        title="Mode plein écran"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AurelieAAN/OP_Project3/master?urlpath=tree/docs/ScriptFood_Analyse_p4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="lancement Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contenu
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#classement-des-aliments">
   1) Classement des aliments
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-correlations-entre-les-variables-quantitatives">
   a) Corrélations entre les variables quantitatives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-analyse-en-composante-principale">
   b) Analyse en composante principale
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#c-classification-ascendante-hierarchique">
   c ) Classification ascendante hiérarchique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#realisons-un-dendrogramme">
     Réalisons un dendrogramme
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-essayons-d-utiliser-kmeans">
   d) Essayons d’utiliser KMeans
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#e-testons-un-mix-de-kmeans-et-cah">
   e) Testons un mix de Kmeans et CAH
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#f-cah-utilisation-des-variables-quantitatives-avec-regroupement">
   f) CAH : Utilisation des variables quantitatives avec regroupement
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="iv-objectif-une-meilleure-sante-pour-tous-application-smart-food">
<h1>IV - Objectif une meilleure santé pour tous : Application Smart Food<a class="headerlink" href="#iv-objectif-une-meilleure-sante-pour-tous-application-smart-food" title="Permalink to this headline">¶</a></h1>
<p>Un classement des aliments et le calcul de leur combinaison permettront d’améliorer la santé des français et les guider vers une alimentation équilibrée sans se priver.</p>
<div class="section" id="classement-des-aliments">
<h2>1) Classement des aliments<a class="headerlink" href="#classement-des-aliments" title="Permalink to this headline">¶</a></h2>
<p>Etudions de plus près nos aliments et regardons qu’elles sont les variables qui permettent d’expliquer au mieux cette population.</p>
<p>Pour commencer, il nous faut exclure les données manquantes et étudier les variables quantitatives qui sont corrélées.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_20608</span><span class="o">/</span><span class="mf">2295596747.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>

<span class="ne">NameError</span>: name &#39;data&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_quanti</span><span class="o">=</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;additives_n&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ingredients_from_palm_oil_n&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ingredients_that_may_be_from_palm_oil_n&#39;</span><span class="p">,</span><span class="s1">&#39;energy_100g&#39;</span><span class="p">,</span> <span class="s1">&#39;fat_100g&#39;</span><span class="p">,</span> <span class="s1">&#39;saturated_fat_100g&#39;</span><span class="p">,</span> <span class="s1">&#39;carbohydrates_100g&#39;</span><span class="p">,</span>
       <span class="s1">&#39;sugars_100g&#39;</span><span class="p">,</span> <span class="s1">&#39;fiber_100g&#39;</span><span class="p">,</span> <span class="s1">&#39;proteins_100g&#39;</span><span class="p">,</span> <span class="s1">&#39;salt_100g&#39;</span><span class="p">,</span>
       <span class="s1">&#39;sodium_100g&#39;</span><span class="p">,</span> 
       <span class="s1">&#39;ingredients_from_palm_oil&#39;</span><span class="p">,</span> <span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-correlations-entre-les-variables-quantitatives">
<h2>a) Corrélations entre les variables quantitatives<a class="headerlink" href="#a-correlations-entre-les-variables-quantitatives" title="Permalink to this headline">¶</a></h2>
<p>Regardons les variables corrélées.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)})</span>

<span class="n">data_corr</span> <span class="o">=</span> <span class="n">data_quanti</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">data_corr</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data_corr</span><span class="p">,</span> <span class="n">xticklabels</span> <span class="o">=</span> <span class="n">data_corr</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> 
                 <span class="n">yticklabels</span> <span class="o">=</span> <span class="n">data_corr</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;rocket_r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matrice de corrélation des variables quantitatives&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Variables&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Variables&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>additives_n</th>
      <th>ingredients_from_palm_oil_n</th>
      <th>ingredients_that_may_be_from_palm_oil_n</th>
      <th>energy_100g</th>
      <th>fat_100g</th>
      <th>saturated_fat_100g</th>
      <th>carbohydrates_100g</th>
      <th>sugars_100g</th>
      <th>fiber_100g</th>
      <th>proteins_100g</th>
      <th>salt_100g</th>
      <th>sodium_100g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>additives_n</th>
      <td>1.000000</td>
      <td>0.079260</td>
      <td>0.306354</td>
      <td>0.214185</td>
      <td>0.140782</td>
      <td>0.166701</td>
      <td>0.146996</td>
      <td>0.094282</td>
      <td>-0.090824</td>
      <td>0.023585</td>
      <td>0.028032</td>
      <td>0.028071</td>
    </tr>
    <tr>
      <th>ingredients_from_palm_oil_n</th>
      <td>0.079260</td>
      <td>1.000000</td>
      <td>0.129211</td>
      <td>0.007568</td>
      <td>0.031469</td>
      <td>0.051081</td>
      <td>0.004500</td>
      <td>-0.017597</td>
      <td>-0.007249</td>
      <td>-0.018253</td>
      <td>0.007822</td>
      <td>0.008002</td>
    </tr>
    <tr>
      <th>ingredients_that_may_be_from_palm_oil_n</th>
      <td>0.306354</td>
      <td>0.129211</td>
      <td>1.000000</td>
      <td>0.096659</td>
      <td>0.076197</td>
      <td>0.115050</td>
      <td>0.071110</td>
      <td>0.058665</td>
      <td>-0.037885</td>
      <td>-0.025630</td>
      <td>-0.017357</td>
      <td>-0.017341</td>
    </tr>
    <tr>
      <th>energy_100g</th>
      <td>0.214185</td>
      <td>0.007568</td>
      <td>0.096659</td>
      <td>1.000000</td>
      <td>0.659098</td>
      <td>0.462246</td>
      <td>0.464224</td>
      <td>0.216972</td>
      <td>0.111850</td>
      <td>0.437464</td>
      <td>0.113597</td>
      <td>0.113471</td>
    </tr>
    <tr>
      <th>fat_100g</th>
      <td>0.140782</td>
      <td>0.031469</td>
      <td>0.076197</td>
      <td>0.659098</td>
      <td>1.000000</td>
      <td>0.723534</td>
      <td>-0.033643</td>
      <td>-0.113009</td>
      <td>-0.026129</td>
      <td>0.265703</td>
      <td>0.088227</td>
      <td>0.088155</td>
    </tr>
    <tr>
      <th>saturated_fat_100g</th>
      <td>0.166701</td>
      <td>0.051081</td>
      <td>0.115050</td>
      <td>0.462246</td>
      <td>0.723534</td>
      <td>1.000000</td>
      <td>0.002535</td>
      <td>0.017851</td>
      <td>-0.071198</td>
      <td>0.169111</td>
      <td>0.009396</td>
      <td>0.009345</td>
    </tr>
    <tr>
      <th>carbohydrates_100g</th>
      <td>0.146996</td>
      <td>0.004500</td>
      <td>0.071110</td>
      <td>0.464224</td>
      <td>-0.033643</td>
      <td>0.002535</td>
      <td>1.000000</td>
      <td>0.622072</td>
      <td>0.301581</td>
      <td>-0.166193</td>
      <td>0.018633</td>
      <td>0.018515</td>
    </tr>
    <tr>
      <th>sugars_100g</th>
      <td>0.094282</td>
      <td>-0.017597</td>
      <td>0.058665</td>
      <td>0.216972</td>
      <td>-0.113009</td>
      <td>0.017851</td>
      <td>0.622072</td>
      <td>1.000000</td>
      <td>-0.083255</td>
      <td>-0.279099</td>
      <td>-0.055417</td>
      <td>-0.055500</td>
    </tr>
    <tr>
      <th>fiber_100g</th>
      <td>-0.090824</td>
      <td>-0.007249</td>
      <td>-0.037885</td>
      <td>0.111850</td>
      <td>-0.026129</td>
      <td>-0.071198</td>
      <td>0.301581</td>
      <td>-0.083255</td>
      <td>1.000000</td>
      <td>0.063904</td>
      <td>0.003881</td>
      <td>0.003837</td>
    </tr>
    <tr>
      <th>proteins_100g</th>
      <td>0.023585</td>
      <td>-0.018253</td>
      <td>-0.025630</td>
      <td>0.437464</td>
      <td>0.265703</td>
      <td>0.169111</td>
      <td>-0.166193</td>
      <td>-0.279099</td>
      <td>0.063904</td>
      <td>1.000000</td>
      <td>0.138959</td>
      <td>0.138884</td>
    </tr>
    <tr>
      <th>salt_100g</th>
      <td>0.028032</td>
      <td>0.007822</td>
      <td>-0.017357</td>
      <td>0.113597</td>
      <td>0.088227</td>
      <td>0.009396</td>
      <td>0.018633</td>
      <td>-0.055417</td>
      <td>0.003881</td>
      <td>0.138959</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>sodium_100g</th>
      <td>0.028071</td>
      <td>0.008002</td>
      <td>-0.017341</td>
      <td>0.113471</td>
      <td>0.088155</td>
      <td>0.009345</td>
      <td>0.018515</td>
      <td>-0.055500</td>
      <td>0.003837</td>
      <td>0.138884</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(62.953124999999986, 0.5, &#39;Variables&#39;)
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_8_2.png" src="_images/ScriptFood_Analyse_p4_8_2.png" />
</div>
</div>
<p>Cette matrice nous permet d’identifier les variables corrélées :</p>
<ul class="simple">
<li><p>fat_100g et saturated_fat_100g</p></li>
<li><p>carbohydrates_100g et sugars_100g</p></li>
<li><p>energy_100g et fat_100g</p></li>
<li><p>salt_100g et sodium_100g</p></li>
<li><p>additives_n et ingredients_that_may_be_from_palm_oil_n</p></li>
</ul>
</div>
<div class="section" id="b-analyse-en-composante-principale">
<h2>b) Analyse en composante principale<a class="headerlink" href="#b-analyse-en-composante-principale" title="Permalink to this headline">¶</a></h2>
<p>Il est necessaire de conserver une des variables corrélées car elles n’apportent aucune information supplémentaires.
Nous excluons les variables suivantes :</p>
<ul class="simple">
<li><p>saturated_fat_100g</p></li>
<li><p>sugars_100g</p></li>
<li><p>energy_100g</p></li>
<li><p>sodium_100g</p></li>
<li><p>ingredients_that_may_be_from_palm_oil_n</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;code&#39;, &#39;product_name&#39;, &#39;ingredients_text&#39;, &#39;energy_100g&#39;,
       &#39;carbohydrates_100g&#39;, &#39;proteins_100g&#39;, &#39;fat_100g&#39;, &#39;saturated_fat_100g&#39;,
       &#39;fiber_100g&#39;, &#39;sugars_100g&#39;, &#39;salt_100g&#39;, &#39;additives_n&#39;,
       &#39;ingredients_from_palm_oil_n&#39;,
       &#39;ingredients_that_may_be_from_palm_oil_n&#39;, &#39;nutrition_grade_fr&#39;,
       &#39;main_category&#39;, &#39;nutrition_score_fr_100g&#39;, &#39;reg_additives&#39;,
       &#39;reg_energy&#39;, &#39;reg_fat&#39;, &#39;reg_carbohydrates&#39;, &#39;reg_fiber&#39;,
       &#39;reg_protein&#39;, &#39;PC1&#39;, &#39;PC2&#39;, &#39;PC3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># suppression des colonnes non numériques</span>
<span class="n">WGI_num0</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;energy_100g&#39;, &#39;carbohydrates_100g&#39;, &#39;proteins_100g&#39;, &#39;fat_100g&#39;,
       &#39;saturated_fat_100g&#39;, &#39;fiber_100g&#39;, &#39;sugars_100g&#39;, &#39;salt_100g&#39;,
       &#39;additives_n&#39;, &#39;ingredients_from_palm_oil_n&#39;,
       &#39;ingredients_that_may_be_from_palm_oil_n&#39;, &#39;nutrition_score_fr_100g&#39;,
       &#39;reg_additives&#39;, &#39;reg_energy&#39;, &#39;reg_fat&#39;, &#39;reg_carbohydrates&#39;,
       &#39;reg_fiber&#39;, &#39;reg_protein&#39;, &#39;PC1&#39;, &#39;PC2&#39;, &#39;PC3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span> <span class="o">=</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;reg_additives&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fat&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_carbohydrates&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fiber&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;reg_protein&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;carbohydrates_100g&#39;, &#39;proteins_100g&#39;, &#39;fat_100g&#39;, &#39;fiber_100g&#39;,
       &#39;salt_100g&#39;, &#39;additives_n&#39;, &#39;PC1&#39;, &#39;PC2&#39;, &#39;PC3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">=</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">carbohydrates_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">proteins_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                      <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">fat_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">[</span><span class="s2">&quot;fiber_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> 
                      <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">[</span><span class="s2">&quot;salt_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                 <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">[</span><span class="s2">&quot;additives_n&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carbohydrates_100g</th>
      <th>proteins_100g</th>
      <th>fat_100g</th>
      <th>fiber_100g</th>
      <th>salt_100g</th>
      <th>additives_n</th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>64838.000000</td>
      <td>64838.000000</td>
      <td>64838.000000</td>
      <td>64838.000000</td>
      <td>64838.000000</td>
      <td>64838.000000</td>
      <td>6.483800e+04</td>
      <td>6.483800e+04</td>
      <td>6.483800e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>12.297465</td>
      <td>4.740160</td>
      <td>3.089099</td>
      <td>1.452355</td>
      <td>0.895311</td>
      <td>1.667032</td>
      <td>3.506797e-18</td>
      <td>-2.323253e-17</td>
      <td>-6.575244e-18</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11.115141</td>
      <td>6.129425</td>
      <td>4.526895</td>
      <td>2.841038</td>
      <td>2.005498</td>
      <td>2.225447</td>
      <td>1.331193e+00</td>
      <td>1.155631e+00</td>
      <td>1.103339e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-6.468289e+00</td>
      <td>-5.809167e+00</td>
      <td>-1.870046e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.760000</td>
      <td>0.700000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.083820</td>
      <td>0.000000</td>
      <td>-8.744800e-01</td>
      <td>-5.712942e-01</td>
      <td>-6.971681e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>10.000000</td>
      <td>2.560000</td>
      <td>1.060000</td>
      <td>0.800000</td>
      <td>0.497840</td>
      <td>1.000000</td>
      <td>-2.928052e-01</td>
      <td>-9.282681e-02</td>
      <td>-2.433862e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>16.670000</td>
      <td>6.060000</td>
      <td>4.550000</td>
      <td>2.000000</td>
      <td>1.036320</td>
      <td>2.000000</td>
      <td>6.945035e-01</td>
      <td>4.573504e-01</td>
      <td>5.328962e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>100.000000</td>
      <td>86.000000</td>
      <td>100.000000</td>
      <td>45.000000</td>
      <td>40.000000</td>
      <td>24.000000</td>
      <td>1.191543e+01</td>
      <td>1.073041e+01</td>
      <td>1.266938e+01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;code&#39;, &#39;product_name&#39;, &#39;ingredients_text&#39;, &#39;energy_100g&#39;,
       &#39;carbohydrates_100g&#39;, &#39;proteins_100g&#39;, &#39;fat_100g&#39;, &#39;saturated_fat_100g&#39;,
       &#39;fiber_100g&#39;, &#39;sugars_100g&#39;, &#39;salt_100g&#39;, &#39;additives_n&#39;,
       &#39;ingredients_from_palm_oil_n&#39;,
       &#39;ingredients_that_may_be_from_palm_oil_n&#39;, &#39;nutrition_grade_fr&#39;,
       &#39;main_category&#39;, &#39;nutrition_score_fr_100g&#39;, &#39;reg_additives&#39;,
       &#39;reg_energy&#39;, &#39;reg_fat&#39;, &#39;reg_carbohydrates&#39;, &#39;reg_fiber&#39;,
       &#39;reg_protein&#39;, &#39;PC1&#39;, &#39;PC2&#39;, &#39;PC3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#instanciation</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1">#transformation – centrage-réduction</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.29936554 -0.5645206  -0.68239314 ... -0.34890905 -0.74908314
  -0.78652822]
 [-0.39923009  0.10112604  0.81754262 ... -0.19761378  0.59897128
  -0.05125205]
 [-0.17071121 -0.77335092 -0.68239314 ... -0.43376643  0.1496198
   1.9707574 ]
 ...
 [-0.18870482 -0.67546171 -0.57194132 ... -0.43147272 -0.74908314
   0.31638603]
 [-1.06139504 -0.69177658 -0.63821242 ... -0.43376643 -0.74908314
  -0.05125205]
 [-1.10637907 -0.77335092 -0.68239314 ... -0.44643171 -0.74908314
  -0.41889014]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1">#calculs</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.43548695, -0.09523998, -0.18520718,  0.37599633,  0.15439028,
         0.25329922],
       [ 0.58212953, -0.48363218, -0.01618492, -0.77344479,  0.05540798,
         0.38261266],
       [ 0.78676156,  0.35783347, -1.53418688,  0.14464768,  0.29785649,
        -0.35711997],
       ...,
       [-0.53849479, -0.10180128, -0.89097704,  0.41998785,  0.5262859 ,
        -0.18719729],
       [-0.81160979, -0.87212805, -1.01871354,  0.39405349,  0.2746659 ,
         0.22536751],
       [-1.06582204, -0.95685293, -1.06194672,  0.34713687,  0.18503225,
         0.31575172]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.77207548 1.3354835  1.217357   0.9978075  0.78926752 0.57167514]
[0.25314974 0.19078041 0.17390546 0.14254173 0.11275076 0.08166662]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;Dimension&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dim&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span> 
        <span class="s2">&quot;Valeurs propres&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">,</span>
        <span class="s2">&quot;% variance expliquée&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span>
        <span class="s2">&quot;</span><span class="si">% c</span><span class="s2">um. var. expliquée&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">eig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dimension</th>
      <th>Valeurs propres</th>
      <th>% variance expliquée</th>
      <th>% cum. var. expliquée</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dim1</td>
      <td>1.772048</td>
      <td>25.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Dim2</td>
      <td>1.335463</td>
      <td>19.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dim3</td>
      <td>1.217338</td>
      <td>17.0</td>
      <td>62.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dim4</td>
      <td>0.997792</td>
      <td>14.0</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dim5</td>
      <td>0.789255</td>
      <td>11.0</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Dim6</td>
      <td>0.571666</td>
      <td>8.0</td>
      <td>95.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Dimension&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">% c</span><span class="s2">um. var. expliquée&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span> <span class="c1"># permet un diagramme en barres</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="s2">&quot;17%&quot;</span><span class="p">)</span> <span class="c1"># ajout de texte</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span> <span class="c1"># ligne 17 = 100 / 6 (nb dimensions)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_23_0.png" src="_images/ScriptFood_Analyse_p4_23_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.25314974, 0.19078041, 0.17390546, 0.14254173, 0.11275076,
       0.08166662])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#cumul de variance expliquée</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Explained variance vs. # of factors&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cumsum explained variance ratio&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Factor number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_25_0.png" src="_images/ScriptFood_Analyse_p4_25_0.png" />
</div>
</div>
<p>On conserve 3 dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transformation en DataFrame pandas</span>
<span class="n">WGI_pca_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Dim1&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> 
    <span class="s2">&quot;Dim2&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;Dim3&quot;</span> <span class="p">:</span> <span class="n">WGI_pca</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
    <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">],</span>
    <span class="s2">&quot;nutrition_grade_fr&quot;</span> <span class="p">:</span> <span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Résultat (premières lignes)</span>
<span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dim1</th>
      <th>Dim2</th>
      <th>Dim3</th>
      <th>product</th>
      <th>nutrition_grade_fr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.450211</td>
      <td>0.254762</td>
      <td>0.386345</td>
      <td>FRESH ORGANIC CARROTS</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.378170</td>
      <td>-0.766225</td>
      <td>-0.308140</td>
      <td>QUICHE LORRAINE</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.786057</td>
      <td>-0.355304</td>
      <td>-1.140910</td>
      <td>PEPSI, NOUVEAU GOÛT !</td>
      <td>E</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.037111</td>
      <td>0.844808</td>
      <td>-0.838885</td>
      <td>ICE CREAM, VANILLA</td>
      <td>D</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.331259</td>
      <td>-0.568884</td>
      <td>0.608698</td>
      <td>ROMAINE HEARTS</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s2">&quot;Dim1&quot;</span><span class="p">,</span> <span class="s2">&quot;Dim2&quot;</span><span class="p">)</span> <span class="c1"># nuage de points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Dimension 1 (24%)&quot;</span><span class="p">)</span> <span class="c1"># modification du nom de l&#39;axe X</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dimension 2 (21%)&quot;</span><span class="p">)</span> <span class="c1"># idem pour axe Y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Premier plan factoriel (45%)&quot;</span><span class="p">)</span> <span class="c1"># titre général</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*c* argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with *x* &amp; *y*.  Please use the *color* keyword-argument or provide a 2D array with a single row if you intend to specify the same RGB or RGBA value for all points.
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_28_1.png" src="_images/ScriptFood_Analyse_p4_28_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.45021125,  0.25476207,  0.38634537, -0.07105427,  0.04411982,
         0.23449925],
       [ 1.37816966, -0.76622548, -0.30814048, -0.52432624,  0.72603436,
         0.77442826],
       [-0.78605699, -0.35530443, -1.14091026,  0.12317251,  0.05242835,
        -0.11921274],
       ...,
       [-1.14907957, -0.61953649, -0.37655285,  0.10699029,  0.53622062,
        -0.44962597],
       [-1.00485924, -1.43430104, -0.13312431,  0.03186367,  0.20530648,
         0.12579092],
       [-1.00851123, -1.43558475, -0.13617038,  0.0202348 ,  0.2056086 ,
         0.12488316]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_components</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Append the principle components for each entry to the dataframe</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">data_study</span><span class="p">[</span><span class="s1">&#39;PC&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

<span class="n">display</span><span class="p">(</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Show the points in terms of the first two PCs</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s1">&#39;PC1&#39;</span><span class="p">,</span>
               <span class="s1">&#39;PC2&#39;</span><span class="p">,</span>
               <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;nutrition_grade_fr&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data_study</span><span class="p">,</span>
               <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carbohydrates_100g</th>
      <th>proteins_100g</th>
      <th>fat_100g</th>
      <th>fiber_100g</th>
      <th>salt_100g</th>
      <th>additives_n</th>
      <th>nutrition_score_fr_100g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.97</td>
      <td>1.28</td>
      <td>0.00</td>
      <td>2.600</td>
      <td>0.19558</td>
      <td>0.0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.86</td>
      <td>5.36</td>
      <td>6.79</td>
      <td>0.357</td>
      <td>0.49900</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.40</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.02540</td>
      <td>2.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22.54</td>
      <td>2.82</td>
      <td>11.27</td>
      <td>0.000</td>
      <td>0.14224</td>
      <td>2.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.53</td>
      <td>1.18</td>
      <td>0.00</td>
      <td>2.400</td>
      <td>0.01524</td>
      <td>0.0</td>
      <td>-3.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aurel\AppData\Roaming\Python\Python39\site-packages\seaborn\_decorators.py:36: FutureWarning:

Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.

C:\Users\aurel\AppData\Roaming\Python\Python39\site-packages\seaborn\regression.py:581: UserWarning:

The `size` parameter has been renamed to `height`; please update your code.
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_31_2.png" src="_images/ScriptFood_Analyse_p4_31_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a variable factor map for the first two dimensions.</span>
<span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
             <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Start the arrow at the origin</span>
             <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>  <span class="c1">#0 for PC1</span>
             <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>  <span class="c1">#1 for PC2</span>
             <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
             <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span>
             <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span>
             <span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


<span class="n">an</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">an</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">an</span><span class="p">))</span>  <span class="c1"># Add a unit circle for scale</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Variable factor map&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_32_0.png" src="_images/ScriptFood_Analyse_p4_32_0.png" />
</div>
</div>
<p>Le premier plan factoriel est expliqué par les variables proteins et fat positivement
Et le second plan factoriel est expliqué par les variables fibres et carbohydrate. Cependant, ces variables sont assez éloignées du bord du cercle.</p>
<p>Nous devons calculer le cosinus au carré pour vérifier les coefficients de corrélation avec nos axes.</p>
<p>Combinons nos deux graphiques précédent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cos2var</span> <span class="o">=</span> <span class="n">corvar</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="s1">&#39;COS2_1&#39;</span><span class="p">:</span><span class="n">cos2var</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;COS2_2&#39;</span><span class="p">:</span><span class="n">cos2var</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;COS2_3&#39;</span><span class="p">:</span><span class="n">cos2var</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  id        COS2_1        COS2_2
0          salt_100g  1.470557e+00  4.076666e-30
1      reg_additives  4.917903e-30  1.219010e+00
2            reg_fat  5.657521e-28  2.562877e-27
3  reg_carbohydrates  6.770696e-30  2.347727e-32
4          reg_fiber  2.205407e-29  1.788405e-29
5        reg_protein  9.034975e-29  7.362473e-31
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#cosinus carré des variables</span>
<span class="n">cos2var</span> <span class="o">=</span> <span class="n">corvar</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="s1">&#39;COS2_1&#39;</span><span class="p">:</span><span class="n">cos2var</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;COS2_2&#39;</span><span class="p">:</span><span class="n">cos2var</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;COS2_3&#39;</span><span class="p">:</span><span class="n">cos2var</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]}))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#contributions</span>
<span class="n">ctrvar</span> <span class="o">=</span> <span class="n">cos2var</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
 <span class="n">ctrvar</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctrvar</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">eigval</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="c1">#on n&#39;affiche que pour les trois premiers axes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="s1">&#39;CTR_1&#39;</span><span class="p">:</span><span class="n">ctrvar</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;CTR_2&#39;</span><span class="p">:</span><span class="n">ctrvar</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;CTR_3&#39;</span><span class="p">:</span><span class="n">ctrvar</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  id         CTR_1         CTR_2         CTR_3
0          salt_100g  6.800143e-01  2.743411e-30  3.580519e-28
1      reg_additives  2.274134e-30  8.203380e-01  1.994777e-27
2            reg_fat  2.616148e-28  1.724699e-27  9.306830e-01
3  reg_carbohydrates  3.130902e-30  1.579914e-32  1.032440e-29
4          reg_fiber  1.019823e-29  1.203515e-29  2.854703e-28
5        reg_protein  4.177948e-29  4.954609e-31  3.716783e-30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####mettre en 3d</span>
<span class="kn">from</span> <span class="nn">yellowbrick.datasets</span> <span class="kn">import</span> <span class="n">load_concrete</span>
<span class="kn">from</span> <span class="nn">yellowbrick.features</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">yellowbrick.style</span> <span class="kn">import</span> <span class="n">set_palette</span>

<span class="c1"># Load the concrete dataset</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">proj_features</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">poof</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_37_0.png" src="_images/ScriptFood_Analyse_p4_37_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:title={&#39;center&#39;:&#39;Principal Component Plot&#39;}, xlabel=&#39;$PC_1$&#39;, ylabel=&#39;$PC_2$&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Nous observons 2 groupes extrêmes :un qui est caractérisé par un fort nombre de carbohydrates et de fibres et le deuxième groupe qui est caractérisé par un fort nombre de protéines et de matières grasses.</p>
<p>Des variables semblent être liées :</p>
<ul class="simple">
<li><p>carbohydrates et fibres</p></li>
<li><p>fat et protéine</p></li>
</ul>
<p>Réalisons une classification hiérarchique afin de classer nos aliments.</p>
</div>
<div class="section" id="c-classification-ascendante-hierarchique">
<h2>c ) Classification ascendante hiérarchique<a class="headerlink" href="#c-classification-ascendante-hierarchique" title="Permalink to this headline">¶</a></h2>
<p>Nous allons extraire un échantillon de notre base de données afin de réduire la population. Les calculs sur une population importante pose problème selon la puissance de l’ordinateur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>B    21172
A    19430
C    16351
D     6838
E     1047
Name: nutrition_grade_fr, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_a</span><span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1100</span><span class="p">)</span>
<span class="n">test_b</span><span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1100</span><span class="p">)</span>
<span class="n">test_c</span><span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1100</span><span class="p">)</span>
<span class="n">test_d</span><span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;D&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1100</span><span class="p">)</span>
<span class="n">test_e</span><span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_study</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1047</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_a</span><span class="p">,</span> <span class="n">test_b</span><span class="p">,</span> <span class="n">test_c</span><span class="p">,</span> <span class="n">test_d</span><span class="p">,</span> <span class="n">test_e</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5447, 24)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test3</span> <span class="o">=</span> <span class="n">test2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;reg_additives&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fat&quot;</span><span class="p">,</span><span class="s2">&quot;reg_carbohydrates&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fiber&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;reg_protein&quot;</span><span class="p">,</span><span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span>  <span class="s2">&quot;sugars_100g&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span> <span class="o">=</span> <span class="n">test2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;reg_additives&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fat&quot;</span><span class="p">,</span><span class="s2">&quot;reg_carbohydrates&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fiber&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;reg_protein&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span><span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span>  <span class="s2">&quot;sugars_100g&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test3</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;carbohydrates_100g&#39;, &#39;proteins_100g&#39;, &#39;fat_100g&#39;, &#39;fiber_100g&#39;,
       &#39;salt_100g&#39;, &#39;additives_n&#39;, &#39;nutrition_score_fr_100g&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carbohydrates_100g</th>
      <th>proteins_100g</th>
      <th>fat_100g</th>
      <th>fiber_100g</th>
      <th>salt_100g</th>
      <th>additives_n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5447.000000</td>
      <td>5447.000000</td>
      <td>5447.00000</td>
      <td>5447.000000</td>
      <td>5447.000000</td>
      <td>5447.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>13.981004</td>
      <td>4.502841</td>
      <td>3.62144</td>
      <td>1.142166</td>
      <td>1.231247</td>
      <td>1.885258</td>
    </tr>
    <tr>
      <th>std</th>
      <td>12.711992</td>
      <td>6.465820</td>
      <td>5.52684</td>
      <td>2.964356</td>
      <td>2.796167</td>
      <td>2.302950</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.360000</td>
      <td>0.100000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.050000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>10.600000</td>
      <td>2.000000</td>
      <td>0.81000</td>
      <td>0.100000</td>
      <td>0.462280</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>18.180000</td>
      <td>5.420000</td>
      <td>5.88000</td>
      <td>1.500000</td>
      <td>1.428740</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>100.000000</td>
      <td>86.000000</td>
      <td>100.00000</td>
      <td>45.000000</td>
      <td>39.794180</td>
      <td>20.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="realisons-un-dendrogramme">
<h3>Réalisons un dendrogramme<a class="headerlink" href="#realisons-un-dendrogramme" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Centrage et Réduction</span>
<span class="n">std_scale</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test2</span><span class="p">)</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">std_scale</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#librairies pour la CAH</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span><span class="p">,</span> <span class="n">fcluster</span>

<span class="c1">#générer la matrice des liens</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
<span class="c1">#affichage du dendrogramme</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;CAH&quot;</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">test2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">color_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_53_0.png" src="_images/ScriptFood_Analyse_p4_53_0.png" />
</div>
</div>
<p>Nous pourrions faire 5 groupes. Réalisons ce découpage en affichant le nutriscore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#matérialisation des 5 classes (hauteur t = 350)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hierarchical Clustering Dendrogram (truncated)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;sample index or (cluster size)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">color_threshold</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
           <span class="n">truncate_mode</span> <span class="o">=</span> <span class="s1">&#39;lastp&#39;</span> <span class="p">,</span>   <span class="c1"># afficher uniquement les p derniers clusters fusionnés </span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">12</span> <span class="p">,</span>   <span class="c1"># afficher uniquement les p derniers clusters fusionnés </span>
   
    <span class="n">leaf_font_size</span> <span class="o">=</span> <span class="mf">12.</span> <span class="p">,</span> 
    <span class="n">show_contracted</span> <span class="o">=</span> <span class="kc">True</span>
          <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_55_0.png" src="_images/ScriptFood_Analyse_p4_55_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#découpage à la hauteur t = 350 ==&gt; identifiants de 5 groupes obtenus</span>
<span class="n">groupes_cah</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">groupes_cah</span><span class="p">)</span>
<span class="c1">#index triés des groupes</span>
<span class="n">idg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">groupes_cah</span><span class="p">)</span>
<span class="c1">#affichage des observatbbions et leurs groupes</span>
<span class="n">info_groupe</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idg</span><span class="p">],</span><span class="n">groupes_cah</span><span class="p">[</span><span class="n">idg</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5 3 2 ... 5 1 4]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">info_groupe</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">nutrition_grade_fr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">tm</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tm</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aurel\AppData\Roaming\Python\Python39\site-packages\seaborn\_decorators.py:36: FutureWarning:

Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x23742b128b0&gt;
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_58_2.png" src="_images/ScriptFood_Analyse_p4_58_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="d-essayons-d-utiliser-kmeans">
<h2>d) Essayons d’utiliser KMeans<a class="headerlink" href="#d-essayons-d-utiliser-kmeans" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>

<span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">KElbowVisualizer</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">WGI_num0</span>
<span class="c1"># Instantiate the clustering model and visualizer</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">()</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">KElbowVisualizer</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;calinski_harabasz&#39;</span><span class="p">,</span> <span class="n">timings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">locate_elbow</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>        <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>        <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_60_0.png" src="_images/ScriptFood_Analyse_p4_60_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:title={&#39;center&#39;:&#39;Calinski Harabasz Score Elbow for KMeans Clustering&#39;}, xlabel=&#39;k&#39;, ylabel=&#39;calinski harabasz score&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yellowbrick.cluster</span> <span class="kn">import</span> <span class="n">KElbowVisualizer</span>

<span class="c1"># Generate synthetic dataset with 8 random clusters</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">WGI_num0</span>

<span class="c1"># Instantiate the clustering model and visualizer</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">()</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">KElbowVisualizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>        <span class="c1"># Fit the data to the visualizer</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>        <span class="c1"># Finalize and render the figure</span>
</pre></div>
</div>
</div>
</div>
<p>Nous essayerons 5 groupes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">kmeans2</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">kmeans2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KMeans(n_clusters=5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 0, 1, ..., 1, 1, 1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    46643
0    15192
4     2380
3      346
2      277
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2.12788087e-01, -7.28384579e-02, -1.92222716e-01,
         1.06846132e+00, -4.31635994e-01, -1.85025624e-01,
         1.21527918e+00,  4.89153707e-01],
       [-1.51205775e-01, -7.28384579e-02, -1.92222716e-01,
        -3.66061956e-01,  1.00883510e-01,  2.08537789e-03,
        -3.98871455e-01, -1.56571685e-01],
       [-4.65196828e-01, -7.28384579e-02, -1.92222716e-01,
        -4.63881956e-01,  3.47205996e+00,  1.16898975e+01,
         2.04440950e+00,  1.49768318e-01],
       [ 1.03793312e+00,  1.35765833e+01,  1.66702248e+00,
         4.91986189e-01,  1.28024367e-01, -4.28262950e-02,
        -1.66782021e-01,  1.27631774e-01],
       [ 1.51334488e+00, -7.28384579e-02,  4.77417964e+00,
         3.56206237e-01,  3.48014406e-01, -2.16729985e-01,
        -1.31633598e-01, -8.09191120e-02]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_k2</span> <span class="o">=</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">WGI_k2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;classe&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>additives_n</th>
      <th>ingredients_from_palm_oil_n</th>
      <th>ingredients_that_may_be_from_palm_oil_n</th>
      <th>fat_100g</th>
      <th>carbohydrates_100g</th>
      <th>fiber_100g</th>
      <th>proteins_100g</th>
      <th>salt_100g</th>
    </tr>
    <tr>
      <th>classe</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.144484</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.924218</td>
      <td>7.525671</td>
      <td>0.927374</td>
      <td>12.173455</td>
      <td>1.874105</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.328688</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.427932</td>
      <td>13.414554</td>
      <td>1.458435</td>
      <td>2.293411</td>
      <td>0.581108</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.631769</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.989170</td>
      <td>50.889603</td>
      <td>34.663538</td>
      <td>17.271119</td>
      <td>1.195669</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.976879</td>
      <td>1.011561</td>
      <td>0.401734</td>
      <td>5.316251</td>
      <td>13.720462</td>
      <td>1.330685</td>
      <td>3.717890</td>
      <td>1.151274</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.034874</td>
      <td>0.000000</td>
      <td>1.073109</td>
      <td>4.701595</td>
      <td>16.165664</td>
      <td>0.836622</td>
      <td>3.933328</td>
      <td>0.733029</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_k2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>additives_n</th>
      <th>ingredients_from_palm_oil_n</th>
      <th>ingredients_that_may_be_from_palm_oil_n</th>
      <th>fat_100g</th>
      <th>carbohydrates_100g</th>
      <th>fiber_100g</th>
      <th>proteins_100g</th>
      <th>salt_100g</th>
      <th>classe</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>8.97</td>
      <td>2.600</td>
      <td>1.28</td>
      <td>0.19558</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.79</td>
      <td>7.86</td>
      <td>0.357</td>
      <td>5.36</td>
      <td>0.49900</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>10.40</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>0.02540</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.27</td>
      <td>22.54</td>
      <td>0.000</td>
      <td>2.82</td>
      <td>0.14224</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>3.53</td>
      <td>2.400</td>
      <td>1.18</td>
      <td>0.01524</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>76476</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>16.67</td>
      <td>10.000</td>
      <td>0.00</td>
      <td>3.21818</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76477</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.33</td>
      <td>13.33</td>
      <td>2.000</td>
      <td>4.67</td>
      <td>1.37160</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76478</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.50</td>
      <td>10.20</td>
      <td>0.600</td>
      <td>0.60</td>
      <td>0.03000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76483</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.20</td>
      <td>0.50</td>
      <td>0.200</td>
      <td>0.50</td>
      <td>0.02540</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76484</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>0.00000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>64838 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Dim1&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Dim2&quot;</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Accent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_69_0.png" src="_images/ScriptFood_Analyse_p4_69_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(64838, 9)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">WGI_pca_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">xs</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim1&quot;</span><span class="p">],</span> 
    <span class="n">ys</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim2&quot;</span><span class="p">],</span> 
    <span class="n">zs</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;Dim3&quot;</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">WGI_pca_k2</span><span class="p">[</span><span class="s2">&quot;classe&quot;</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Dim 1 (35%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Dim 2(30%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Dim 3 (21%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aurel\AppData\Local\Temp/ipykernel_3032/4273427348.py:1: MatplotlibDeprecationWarning:

Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_71_1.png" src="_images/ScriptFood_Analyse_p4_71_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="n">n_init</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">)</span>
    <span class="n">inertia</span> <span class="o">=</span> <span class="n">inertia</span> <span class="o">+</span> <span class="p">[</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">]</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;k&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="s2">&quot;inertia&quot;</span><span class="p">:</span> <span class="n">inertia</span><span class="p">})</span>
<span class="n">inertia</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;inertia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">inertia</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;k == 2&#39;</span><span class="p">)[</span><span class="s2">&quot;inertia&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">inertia</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;k == 4&#39;</span><span class="p">)[</span><span class="s2">&quot;inertia&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_72_0.png" src="_images/ScriptFood_Analyse_p4_72_0.png" />
</div>
</div>
<p>coude plus marqué au niveau du 4</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dim1</th>
      <th>Dim2</th>
      <th>Dim3</th>
      <th>Dim4</th>
      <th>Dim5</th>
      <th>Dim6</th>
      <th>product</th>
      <th>nutrition_grade_fr</th>
      <th>classe</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.136592</td>
      <td>0.298666</td>
      <td>-0.193063</td>
      <td>0.287973</td>
      <td>-0.117229</td>
      <td>-0.312695</td>
      <td>FRESH ORGANIC CARROTS</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.596935</td>
      <td>-0.589825</td>
      <td>-0.251736</td>
      <td>-0.267180</td>
      <td>-0.328047</td>
      <td>0.589828</td>
      <td>QUICHE LORRAINE</td>
      <td>B</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.582505</td>
      <td>0.374299</td>
      <td>-0.993721</td>
      <td>-0.171078</td>
      <td>0.093119</td>
      <td>0.109037</td>
      <td>PEPSI, NOUVEAU GOÛT !</td>
      <td>E</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.773482</td>
      <td>0.008422</td>
      <td>0.219318</td>
      <td>-0.407031</td>
      <td>-0.481190</td>
      <td>1.767529</td>
      <td>ICE CREAM, VANILLA</td>
      <td>D</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.191909</td>
      <td>-0.005280</td>
      <td>-0.452546</td>
      <td>0.345469</td>
      <td>-0.216621</td>
      <td>-0.429060</td>
      <td>ROMAINE HEARTS</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>76476</th>
      <td>-1.106544</td>
      <td>1.431242</td>
      <td>2.177748</td>
      <td>0.555039</td>
      <td>0.709371</td>
      <td>-0.873285</td>
      <td>CHIPOTLE PEPPERS IN ADOBO SAUCE</td>
      <td>C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76477</th>
      <td>-0.302272</td>
      <td>-0.290368</td>
      <td>0.517617</td>
      <td>0.139850</td>
      <td>0.061197</td>
      <td>0.297056</td>
      <td>DAL MAKHANI</td>
      <td>B</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76478</th>
      <td>-1.053880</td>
      <td>0.162916</td>
      <td>-0.663141</td>
      <td>0.133020</td>
      <td>-0.012048</td>
      <td>0.018949</td>
      <td>100% PUR JUS 4 AGRUMES</td>
      <td>C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76483</th>
      <td>-1.150123</td>
      <td>-0.398266</td>
      <td>-1.095375</td>
      <td>0.225410</td>
      <td>-0.032823</td>
      <td>-0.248299</td>
      <td>THÉ VERT EARL GREY</td>
      <td>C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76484</th>
      <td>-1.190494</td>
      <td>-0.393670</td>
      <td>-1.206885</td>
      <td>0.214710</td>
      <td>0.000364</td>
      <td>-0.239376</td>
      <td>MINT MELANGE TEA A BLEND OF PEPPERMINT, LEMON ...</td>
      <td>B</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>64838 rows × 9 columns</p>
</div></div></div>
</div>
<p>Ces 4 classes vont permettre de manger équilibrer en les combinant.</p>
<p>Comparons les nouveaux groupes et le nutriscore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>nutrition_grade_fr</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
    <tr>
      <th>classe</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.051097</td>
      <td>0.050233</td>
      <td>0.071100</td>
      <td>0.059440</td>
      <td>0.002437</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.239119</td>
      <td>0.264397</td>
      <td>0.163700</td>
      <td>0.039344</td>
      <td>0.012817</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.003532</td>
      <td>0.000046</td>
      <td>0.000447</td>
      <td>0.000154</td>
      <td>0.000093</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000586</td>
      <td>0.001619</td>
      <td>0.002622</td>
      <td>0.000494</td>
      <td>0.000015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.005336</td>
      <td>0.010241</td>
      <td>0.014313</td>
      <td>0.006030</td>
      <td>0.000787</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;classe&#39;, ylabel=&#39;nutrition_grade_fr&#39;&gt;
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_78_1.png" src="_images/ScriptFood_Analyse_p4_78_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">nutrition_grade_fr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">tm</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tm</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aurel\AppData\Roaming\Python\Python39\site-packages\seaborn\_decorators.py:36: FutureWarning:

Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x23681eb1d90&gt;
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_79_2.png" src="_images/ScriptFood_Analyse_p4_79_2.png" />
</div>
</div>
<p>Aucun groupe ne semble se demarquer, excepté la classe 2.</p>
<p>Les autres groupes sont homogènes. Ce découpage ne semble pas adapter et est assez aléatoire.</p>
</div>
<div class="section" id="e-testons-un-mix-de-kmeans-et-cah">
<h2>e) Testons un mix de Kmeans et CAH<a class="headerlink" href="#e-testons-un-mix-de-kmeans-et-cah" title="Permalink to this headline">¶</a></h2>
<p>Créons un nombre de groupe important avec kmeans</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">scale</span>
<span class="c1"># suppression des co!lonnes non numériques</span>
<span class="n">WGI_num0</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">WGI_num0</span> <span class="o">=</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;reg_additives&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fat&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_carbohydrates&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_fiber&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;reg_protein&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">])</span>
<span class="n">WGI_num0</span><span class="o">=</span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">carbohydrates_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">proteins_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> 
                       <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">fat_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
       <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;fiber_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                       <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;salt_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                 <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                 <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;additives_n&quot;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;carbohydrates_100g&#39;, &#39;proteins_100g&#39;, &#39;fat_100g&#39;, &#39;fiber_100g&#39;,
       &#39;salt_100g&#39;, &#39;additives_n&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num0</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(64838, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">kmeans2</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">kmeans2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">WGI_num0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KMeans(n_clusters=50)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span><span class="o">=</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(64838,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centroid</span><span class="o">=</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#perform the clustering</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">centroid</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#affichage du dendrogramme</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;CAH&quot;</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">color_threshold</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_91_0.png" src="_images/ScriptFood_Analyse_p4_91_0.png" />
</div>
</div>
<p>Réalisons la CAH sur le centre des clusters</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#découpage à la hauteur t = 400 ==&gt; identifiants de 5 groupes obtenus</span>
<span class="n">groupes_cah</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">groupes_cah</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5 5 5 5 1 2 5 5 5 5 5 5 5 5 5 5 5 5 5 5 3 5 1 5 5 5 5 5 5 6 5 3 5 5 5 3 5
 5 5 4 5 5 2 5 5 5 3 4 1 5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index triés des groupes</span>
<span class="n">idg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">groupes_cah</span><span class="p">)</span>
<span class="c1">#affichage des observatbbions et leurs groupes</span>
<span class="n">info_groupe</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">centroid</span><span class="p">[</span><span class="n">idg</span><span class="p">],</span><span class="n">groupes_cah</span><span class="p">[</span><span class="n">idg</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_groupe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>-0.477576</td>
      <td>-0.019263</td>
      <td>-0.431788</td>
      <td>-0.416685</td>
      <td>10.713555</td>
      <td>-0.201691</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.609830</td>
      <td>-0.726038</td>
      <td>-0.618331</td>
      <td>-0.511210</td>
      <td>12.705637</td>
      <td>-0.260658</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.229781</td>
      <td>-0.459716</td>
      <td>-0.642334</td>
      <td>-0.287409</td>
      <td>16.619674</td>
      <td>-0.024755</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.381427</td>
      <td>2.684852</td>
      <td>-0.581699</td>
      <td>13.159430</td>
      <td>-0.339488</td>
      <td>-0.701024</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.178492</td>
      <td>0.621858</td>
      <td>-0.312878</td>
      <td>10.215415</td>
      <td>0.239029</td>
      <td>-0.079461</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.142373</td>
      <td>0.708996</td>
      <td>-0.077384</td>
      <td>3.676401</td>
      <td>5.786269</td>
      <td>-0.353964</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.251143</td>
      <td>-0.256176</td>
      <td>-0.303649</td>
      <td>-0.215730</td>
      <td>3.726618</td>
      <td>0.141012</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.125263</td>
      <td>0.818988</td>
      <td>-0.064911</td>
      <td>-0.230046</td>
      <td>6.266536</td>
      <td>-0.287192</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.541169</td>
      <td>-0.660873</td>
      <td>-0.555087</td>
      <td>-0.280834</td>
      <td>1.953473</td>
      <td>0.001195</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.731428</td>
      <td>-0.230935</td>
      <td>-0.260564</td>
      <td>-0.083148</td>
      <td>-0.151862</td>
      <td>-0.106215</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.845060</td>
      <td>-0.607196</td>
      <td>-0.637329</td>
      <td>-0.283424</td>
      <td>-0.373783</td>
      <td>4.713747</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.600886</td>
      <td>-0.590755</td>
      <td>-0.571269</td>
      <td>-0.119024</td>
      <td>-0.062811</td>
      <td>-0.048944</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.489541</td>
      <td>-0.378341</td>
      <td>3.062727</td>
      <td>-0.155629</td>
      <td>0.145759</td>
      <td>-0.318002</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.440525</td>
      <td>-0.483537</td>
      <td>-0.579312</td>
      <td>0.448554</td>
      <td>-0.183937</td>
      <td>-0.678756</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.427924</td>
      <td>0.754340</td>
      <td>-0.329155</td>
      <td>-0.336357</td>
      <td>-0.202066</td>
      <td>-0.183215</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.619631</td>
      <td>-0.331650</td>
      <td>-0.209922</td>
      <td>-0.210204</td>
      <td>-0.180660</td>
      <td>2.025467</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.422284</td>
      <td>0.227475</td>
      <td>-0.184829</td>
      <td>2.030666</td>
      <td>-0.007547</td>
      <td>-0.256545</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.430018</td>
      <td>1.146206</td>
      <td>0.875023</td>
      <td>0.060279</td>
      <td>0.110990</td>
      <td>-0.107631</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.626713</td>
      <td>4.917063</td>
      <td>0.380763</td>
      <td>-0.440446</td>
      <td>1.467652</td>
      <td>0.072388</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.327398</td>
      <td>-0.661932</td>
      <td>-0.602060</td>
      <td>-0.368102</td>
      <td>0.923300</td>
      <td>-0.319226</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.163871</td>
      <td>0.338270</td>
      <td>1.393584</td>
      <td>1.993786</td>
      <td>0.102408</td>
      <td>-0.290886</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.160722</td>
      <td>-0.208020</td>
      <td>-0.411867</td>
      <td>-0.277308</td>
      <td>-0.267346</td>
      <td>1.437985</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.476860</td>
      <td>-0.219318</td>
      <td>-0.141835</td>
      <td>-0.405433</td>
      <td>-0.320478</td>
      <td>-0.656481</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.424223</td>
      <td>-0.011614</td>
      <td>1.487071</td>
      <td>-0.160563</td>
      <td>-0.056113</td>
      <td>-0.311675</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.142423</td>
      <td>-0.033927</td>
      <td>0.803872</td>
      <td>-0.065280</td>
      <td>0.009053</td>
      <td>1.062775</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.721525</td>
      <td>1.802456</td>
      <td>-0.066367</td>
      <td>-0.444500</td>
      <td>0.452691</td>
      <td>1.418233</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.226076</td>
      <td>-0.295534</td>
      <td>-0.303157</td>
      <td>-0.278436</td>
      <td>-0.199604</td>
      <td>2.875933</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.613415</td>
      <td>-0.457432</td>
      <td>2.326485</td>
      <td>0.188947</td>
      <td>1.984941</td>
      <td>0.007776</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.857991</td>
      <td>-0.160006</td>
      <td>1.432453</td>
      <td>-0.001438</td>
      <td>-0.100648</td>
      <td>-0.211624</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.148970</td>
      <td>-0.666888</td>
      <td>-0.638096</td>
      <td>-0.204581</td>
      <td>-0.393112</td>
      <td>-0.580770</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.672617</td>
      <td>-0.597159</td>
      <td>-0.513636</td>
      <td>-0.397280</td>
      <td>-0.222952</td>
      <td>1.073483</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.987523</td>
      <td>2.523022</td>
      <td>-0.239795</td>
      <td>-0.451276</td>
      <td>0.087389</td>
      <td>-0.414873</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.006799</td>
      <td>-0.605210</td>
      <td>-0.628359</td>
      <td>-0.265070</td>
      <td>-0.029050</td>
      <td>-0.072043</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.127815</td>
      <td>-0.148470</td>
      <td>1.337537</td>
      <td>-0.302403</td>
      <td>-0.257516</td>
      <td>1.292019</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.472125</td>
      <td>-0.216648</td>
      <td>2.727942</td>
      <td>-0.244740</td>
      <td>0.219746</td>
      <td>1.248371</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.772227</td>
      <td>-0.639358</td>
      <td>-0.645013</td>
      <td>-0.322778</td>
      <td>-0.274512</td>
      <td>-0.680834</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.294920</td>
      <td>0.069519</td>
      <td>-0.514178</td>
      <td>1.286298</td>
      <td>-0.137446</td>
      <td>-0.519771</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.898576</td>
      <td>0.726956</td>
      <td>-0.099329</td>
      <td>4.828710</td>
      <td>0.170642</td>
      <td>1.252323</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.351279</td>
      <td>0.212585</td>
      <td>1.281115</td>
      <td>-0.095679</td>
      <td>0.085870</td>
      <td>3.241604</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.675954</td>
      <td>1.679817</td>
      <td>1.842168</td>
      <td>-0.322737</td>
      <td>0.533261</td>
      <td>1.138036</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.328036</td>
      <td>-0.301402</td>
      <td>0.450733</td>
      <td>0.092891</td>
      <td>0.019674</td>
      <td>-0.372551</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.950383</td>
      <td>2.658452</td>
      <td>1.270665</td>
      <td>-0.411008</td>
      <td>0.247177</td>
      <td>-0.579296</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.846858</td>
      <td>1.614946</td>
      <td>2.109041</td>
      <td>-0.336190</td>
      <td>0.093192</td>
      <td>-0.502665</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.404846</td>
      <td>0.107575</td>
      <td>0.127117</td>
      <td>0.185715</td>
      <td>-0.080625</td>
      <td>0.652940</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.185095</td>
      <td>-0.507556</td>
      <td>-0.476741</td>
      <td>-0.241033</td>
      <td>-0.330066</td>
      <td>0.322518</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.528388</td>
      <td>0.458109</td>
      <td>6.691512</td>
      <td>0.764031</td>
      <td>-0.055476</td>
      <td>-0.232807</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.813977</td>
      <td>0.229468</td>
      <td>0.520374</td>
      <td>0.048219</td>
      <td>-0.006248</td>
      <td>5.487605</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.703504</td>
      <td>-0.019420</td>
      <td>0.112596</td>
      <td>0.104307</td>
      <td>-0.153555</td>
      <td>-0.529757</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.724287</td>
      <td>-0.520170</td>
      <td>-0.490948</td>
      <td>-0.097947</td>
      <td>-0.288456</td>
      <td>-0.346644</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.073790</td>
      <td>-0.679301</td>
      <td>19.294184</td>
      <td>-0.500857</td>
      <td>-0.196817</td>
      <td>-0.616921</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Faisons une jointure entre kmeans et cah</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_groupe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>-0.477576</td>
      <td>-0.019263</td>
      <td>-0.431788</td>
      <td>-0.416685</td>
      <td>10.713555</td>
      <td>-0.201691</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.609830</td>
      <td>-0.726038</td>
      <td>-0.618331</td>
      <td>-0.511210</td>
      <td>12.705637</td>
      <td>-0.260658</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.229781</td>
      <td>-0.459716</td>
      <td>-0.642334</td>
      <td>-0.287409</td>
      <td>16.619674</td>
      <td>-0.024755</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.381427</td>
      <td>2.684852</td>
      <td>-0.581699</td>
      <td>13.159430</td>
      <td>-0.339488</td>
      <td>-0.701024</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.178492</td>
      <td>0.621858</td>
      <td>-0.312878</td>
      <td>10.215415</td>
      <td>0.239029</td>
      <td>-0.079461</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.142373</td>
      <td>0.708996</td>
      <td>-0.077384</td>
      <td>3.676401</td>
      <td>5.786269</td>
      <td>-0.353964</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.251143</td>
      <td>-0.256176</td>
      <td>-0.303649</td>
      <td>-0.215730</td>
      <td>3.726618</td>
      <td>0.141012</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.125263</td>
      <td>0.818988</td>
      <td>-0.064911</td>
      <td>-0.230046</td>
      <td>6.266536</td>
      <td>-0.287192</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.541169</td>
      <td>-0.660873</td>
      <td>-0.555087</td>
      <td>-0.280834</td>
      <td>1.953473</td>
      <td>0.001195</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.731428</td>
      <td>-0.230935</td>
      <td>-0.260564</td>
      <td>-0.083148</td>
      <td>-0.151862</td>
      <td>-0.106215</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.845060</td>
      <td>-0.607196</td>
      <td>-0.637329</td>
      <td>-0.283424</td>
      <td>-0.373783</td>
      <td>4.713747</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.600886</td>
      <td>-0.590755</td>
      <td>-0.571269</td>
      <td>-0.119024</td>
      <td>-0.062811</td>
      <td>-0.048944</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.489541</td>
      <td>-0.378341</td>
      <td>3.062727</td>
      <td>-0.155629</td>
      <td>0.145759</td>
      <td>-0.318002</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.440525</td>
      <td>-0.483537</td>
      <td>-0.579312</td>
      <td>0.448554</td>
      <td>-0.183937</td>
      <td>-0.678756</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.427924</td>
      <td>0.754340</td>
      <td>-0.329155</td>
      <td>-0.336357</td>
      <td>-0.202066</td>
      <td>-0.183215</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.619631</td>
      <td>-0.331650</td>
      <td>-0.209922</td>
      <td>-0.210204</td>
      <td>-0.180660</td>
      <td>2.025467</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.422284</td>
      <td>0.227475</td>
      <td>-0.184829</td>
      <td>2.030666</td>
      <td>-0.007547</td>
      <td>-0.256545</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.430018</td>
      <td>1.146206</td>
      <td>0.875023</td>
      <td>0.060279</td>
      <td>0.110990</td>
      <td>-0.107631</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.626713</td>
      <td>4.917063</td>
      <td>0.380763</td>
      <td>-0.440446</td>
      <td>1.467652</td>
      <td>0.072388</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.327398</td>
      <td>-0.661932</td>
      <td>-0.602060</td>
      <td>-0.368102</td>
      <td>0.923300</td>
      <td>-0.319226</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.163871</td>
      <td>0.338270</td>
      <td>1.393584</td>
      <td>1.993786</td>
      <td>0.102408</td>
      <td>-0.290886</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.160722</td>
      <td>-0.208020</td>
      <td>-0.411867</td>
      <td>-0.277308</td>
      <td>-0.267346</td>
      <td>1.437985</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.476860</td>
      <td>-0.219318</td>
      <td>-0.141835</td>
      <td>-0.405433</td>
      <td>-0.320478</td>
      <td>-0.656481</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.424223</td>
      <td>-0.011614</td>
      <td>1.487071</td>
      <td>-0.160563</td>
      <td>-0.056113</td>
      <td>-0.311675</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.142423</td>
      <td>-0.033927</td>
      <td>0.803872</td>
      <td>-0.065280</td>
      <td>0.009053</td>
      <td>1.062775</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.721525</td>
      <td>1.802456</td>
      <td>-0.066367</td>
      <td>-0.444500</td>
      <td>0.452691</td>
      <td>1.418233</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.226076</td>
      <td>-0.295534</td>
      <td>-0.303157</td>
      <td>-0.278436</td>
      <td>-0.199604</td>
      <td>2.875933</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.613415</td>
      <td>-0.457432</td>
      <td>2.326485</td>
      <td>0.188947</td>
      <td>1.984941</td>
      <td>0.007776</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.857991</td>
      <td>-0.160006</td>
      <td>1.432453</td>
      <td>-0.001438</td>
      <td>-0.100648</td>
      <td>-0.211624</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.148970</td>
      <td>-0.666888</td>
      <td>-0.638096</td>
      <td>-0.204581</td>
      <td>-0.393112</td>
      <td>-0.580770</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.672617</td>
      <td>-0.597159</td>
      <td>-0.513636</td>
      <td>-0.397280</td>
      <td>-0.222952</td>
      <td>1.073483</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.987523</td>
      <td>2.523022</td>
      <td>-0.239795</td>
      <td>-0.451276</td>
      <td>0.087389</td>
      <td>-0.414873</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.006799</td>
      <td>-0.605210</td>
      <td>-0.628359</td>
      <td>-0.265070</td>
      <td>-0.029050</td>
      <td>-0.072043</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.127815</td>
      <td>-0.148470</td>
      <td>1.337537</td>
      <td>-0.302403</td>
      <td>-0.257516</td>
      <td>1.292019</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.472125</td>
      <td>-0.216648</td>
      <td>2.727942</td>
      <td>-0.244740</td>
      <td>0.219746</td>
      <td>1.248371</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.772227</td>
      <td>-0.639358</td>
      <td>-0.645013</td>
      <td>-0.322778</td>
      <td>-0.274512</td>
      <td>-0.680834</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.294920</td>
      <td>0.069519</td>
      <td>-0.514178</td>
      <td>1.286298</td>
      <td>-0.137446</td>
      <td>-0.519771</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.898576</td>
      <td>0.726956</td>
      <td>-0.099329</td>
      <td>4.828710</td>
      <td>0.170642</td>
      <td>1.252323</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.351279</td>
      <td>0.212585</td>
      <td>1.281115</td>
      <td>-0.095679</td>
      <td>0.085870</td>
      <td>3.241604</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.675954</td>
      <td>1.679817</td>
      <td>1.842168</td>
      <td>-0.322737</td>
      <td>0.533261</td>
      <td>1.138036</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.328036</td>
      <td>-0.301402</td>
      <td>0.450733</td>
      <td>0.092891</td>
      <td>0.019674</td>
      <td>-0.372551</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.950383</td>
      <td>2.658452</td>
      <td>1.270665</td>
      <td>-0.411008</td>
      <td>0.247177</td>
      <td>-0.579296</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.846858</td>
      <td>1.614946</td>
      <td>2.109041</td>
      <td>-0.336190</td>
      <td>0.093192</td>
      <td>-0.502665</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.404846</td>
      <td>0.107575</td>
      <td>0.127117</td>
      <td>0.185715</td>
      <td>-0.080625</td>
      <td>0.652940</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.185095</td>
      <td>-0.507556</td>
      <td>-0.476741</td>
      <td>-0.241033</td>
      <td>-0.330066</td>
      <td>0.322518</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.528388</td>
      <td>0.458109</td>
      <td>6.691512</td>
      <td>0.764031</td>
      <td>-0.055476</td>
      <td>-0.232807</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.813977</td>
      <td>0.229468</td>
      <td>0.520374</td>
      <td>0.048219</td>
      <td>-0.006248</td>
      <td>5.487605</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.703504</td>
      <td>-0.019420</td>
      <td>0.112596</td>
      <td>0.104307</td>
      <td>-0.153555</td>
      <td>-0.529757</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.724287</td>
      <td>-0.520170</td>
      <td>-0.490948</td>
      <td>-0.097947</td>
      <td>-0.288456</td>
      <td>-0.346644</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.073790</td>
      <td>-0.679301</td>
      <td>19.294184</td>
      <td>-0.500857</td>
      <td>-0.196817</td>
      <td>-0.616921</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_map</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">cluster_map</span><span class="p">[</span><span class="s1">&#39;data_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGI_num0</span><span class="o">.</span><span class="n">index</span>
<span class="n">cluster_map</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">(</span><span class="n">cluster_map</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centroid_map</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">cluster_map</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">centroid_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span><span class="n">kmeans2</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centroid_map</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(50, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_groupe</span><span class="p">[</span><span class="s2">&quot;classe_cah&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">info_groupe</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_index</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>30</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>64833</th>
      <td>76476</td>
      <td>11</td>
    </tr>
    <tr>
      <th>64834</th>
      <td>76477</td>
      <td>15</td>
    </tr>
    <tr>
      <th>64835</th>
      <td>76478</td>
      <td>2</td>
    </tr>
    <tr>
      <th>64836</th>
      <td>76483</td>
      <td>10</td>
    </tr>
    <tr>
      <th>64837</th>
      <td>76484</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>64838 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">centroid_map</span><span class="p">,</span> <span class="n">info_groupe</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;5&quot;</span><span class="p">],</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;_del&#39;</span><span class="p">))</span>
<span class="n">data_result</span> <span class="o">=</span> <span class="n">data_merge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_merge</span><span class="p">[</span><span class="s2">&quot;_merge&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_merge&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cah</span><span class="o">=</span><span class="n">data_result</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_map</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_index</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>64838.000000</td>
      <td>64838.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>34432.880795</td>
      <td>19.098846</td>
    </tr>
    <tr>
      <th>std</th>
      <td>21174.272573</td>
      <td>14.793542</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>16414.250000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33182.500000</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>50019.750000</td>
      <td>30.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>76484.000000</td>
      <td>49.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cluster_map</span><span class="p">,</span> <span class="n">cah</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">],</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;_del&#39;</span><span class="p">))</span>
<span class="n">data_result</span> <span class="o">=</span> <span class="n">data_merge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_merge</span><span class="p">[</span><span class="s2">&quot;_merge&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_merge&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix_kmeans_cah</span><span class="o">=</span><span class="n">data_result</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix_kmeans_cah</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data_index</th>
      <th>cluster</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>classe_cah</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>30</td>
      <td>-0.440525</td>
      <td>-0.483537</td>
      <td>-0.579312</td>
      <td>0.448554</td>
      <td>-0.183937</td>
      <td>-0.678756</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>34</td>
      <td>-0.142423</td>
      <td>-0.033927</td>
      <td>0.803872</td>
      <td>-0.065280</td>
      <td>0.009053</td>
      <td>1.062775</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>19</td>
      <td>0.185095</td>
      <td>-0.507556</td>
      <td>-0.476741</td>
      <td>-0.241033</td>
      <td>-0.330066</td>
      <td>0.322518</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>0.857991</td>
      <td>-0.160006</td>
      <td>1.432453</td>
      <td>-0.001438</td>
      <td>-0.100648</td>
      <td>-0.211624</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>30</td>
      <td>-0.440525</td>
      <td>-0.483537</td>
      <td>-0.579312</td>
      <td>0.448554</td>
      <td>-0.183937</td>
      <td>-0.678756</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>64833</th>
      <td>76476</td>
      <td>11</td>
      <td>0.294920</td>
      <td>0.069519</td>
      <td>-0.514178</td>
      <td>1.286298</td>
      <td>-0.137446</td>
      <td>-0.519771</td>
      <td>5</td>
    </tr>
    <tr>
      <th>64834</th>
      <td>76477</td>
      <td>15</td>
      <td>-0.328036</td>
      <td>-0.301402</td>
      <td>0.450733</td>
      <td>0.092891</td>
      <td>0.019674</td>
      <td>-0.372551</td>
      <td>5</td>
    </tr>
    <tr>
      <th>64835</th>
      <td>76478</td>
      <td>2</td>
      <td>0.148970</td>
      <td>-0.666888</td>
      <td>-0.638096</td>
      <td>-0.204581</td>
      <td>-0.393112</td>
      <td>-0.580770</td>
      <td>5</td>
    </tr>
    <tr>
      <th>64836</th>
      <td>76483</td>
      <td>10</td>
      <td>-0.772227</td>
      <td>-0.639358</td>
      <td>-0.645013</td>
      <td>-0.322778</td>
      <td>-0.274512</td>
      <td>-0.680834</td>
      <td>5</td>
    </tr>
    <tr>
      <th>64837</th>
      <td>76484</td>
      <td>10</td>
      <td>-0.772227</td>
      <td>-0.639358</td>
      <td>-0.645013</td>
      <td>-0.322778</td>
      <td>-0.274512</td>
      <td>-0.680834</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>64838 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>product_name</th>
      <th>ingredients_text</th>
      <th>energy_100g</th>
      <th>carbohydrates_100g</th>
      <th>proteins_100g</th>
      <th>fat_100g</th>
      <th>saturated_fat_100g</th>
      <th>fiber_100g</th>
      <th>sugars_100g</th>
      <th>...</th>
      <th>ingredients_that_may_be_from_palm_oil_n</th>
      <th>nutrition_grade_fr</th>
      <th>main_category</th>
      <th>nutrition_score_fr_100g</th>
      <th>reg_additives</th>
      <th>reg_energy</th>
      <th>reg_fat</th>
      <th>reg_carbohydrates</th>
      <th>reg_fiber</th>
      <th>reg_protein</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000000069601</td>
      <td>FRESH ORGANIC CARROTS</td>
      <td>FRESH ORGANIC CARROTS</td>
      <td>159.0</td>
      <td>8.97</td>
      <td>1.28</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2.600</td>
      <td>6.410</td>
      <td>...</td>
      <td>0.0</td>
      <td>A</td>
      <td>AUTRES</td>
      <td>-2.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-5.00</td>
      <td>3.0</td>
      <td>1.25</td>
      <td>-5.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000008237798</td>
      <td>QUICHE LORRAINE</td>
      <td>INGRÉDIENTS : GARNITURE (SUBSTANCES LAITIÈRES....</td>
      <td>478.0</td>
      <td>7.86</td>
      <td>5.36</td>
      <td>6.79</td>
      <td>2.86</td>
      <td>0.357</td>
      <td>0.714</td>
      <td>...</td>
      <td>0.0</td>
      <td>B</td>
      <td>EN:MEALS</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>327.0</td>
      <td>6.58</td>
      <td>3.0</td>
      <td>-5.00</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000040608754</td>
      <td>PEPSI, NOUVEAU GOÛT !</td>
      <td>EAU GAZÉIFIÉE, SUCRE, COLORANT CARAMEL E150D, ...</td>
      <td>177.0</td>
      <td>10.40</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>10.400</td>
      <td>...</td>
      <td>0.0</td>
      <td>E</td>
      <td>EN:SODAS</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>169.0</td>
      <td>-5.00</td>
      <td>NaN</td>
      <td>-5.00</td>
      <td>-5.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000450193000</td>
      <td>ICE CREAM, VANILLA</td>
      <td>MILK, CREAM, SUGAR, CORN SYRUP, GUAR GUM, LOCU...</td>
      <td>883.0</td>
      <td>22.54</td>
      <td>2.82</td>
      <td>11.27</td>
      <td>7.04</td>
      <td>0.000</td>
      <td>16.900</td>
      <td>...</td>
      <td>0.0</td>
      <td>D</td>
      <td>AUTRES</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>709.0</td>
      <td>6.58</td>
      <td>5.0</td>
      <td>-5.00</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0000651003214</td>
      <td>ROMAINE HEARTS</td>
      <td>ROMAINE HEARTS.</td>
      <td>75.0</td>
      <td>3.53</td>
      <td>1.18</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2.400</td>
      <td>1.180</td>
      <td>...</td>
      <td>0.0</td>
      <td>A</td>
      <td>AUTRES</td>
      <td>-3.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-5.00</td>
      <td>1.0</td>
      <td>1.25</td>
      <td>-5.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>76476</th>
      <td>95656335</td>
      <td>CHIPOTLE PEPPERS IN ADOBO SAUCE</td>
      <td>CHIPOTLE PEPPERS, WATER, VINEGAR, TOMATOES, ON...</td>
      <td>280.0</td>
      <td>16.67</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10.000</td>
      <td>6.670</td>
      <td>...</td>
      <td>0.0</td>
      <td>C</td>
      <td>AUTRES</td>
      <td>6.0</td>
      <td>-5.0</td>
      <td>169.0</td>
      <td>-5.00</td>
      <td>5.0</td>
      <td>9.60</td>
      <td>-5.00</td>
    </tr>
    <tr>
      <th>76477</th>
      <td>95659305</td>
      <td>DAL MAKHANI</td>
      <td>TOMATO, BLACK GRAM, WATER, MILK CREAM, COTTONS...</td>
      <td>502.0</td>
      <td>13.33</td>
      <td>4.67</td>
      <td>5.33</td>
      <td>1.00</td>
      <td>2.000</td>
      <td>0.000</td>
      <td>...</td>
      <td>0.0</td>
      <td>B</td>
      <td>AUTRES</td>
      <td>2.0</td>
      <td>-5.0</td>
      <td>327.0</td>
      <td>2.25</td>
      <td>NaN</td>
      <td>1.25</td>
      <td>2.26</td>
    </tr>
    <tr>
      <th>76478</th>
      <td>9577283844672</td>
      <td>100% PUR JUS 4 AGRUMES</td>
      <td>JUS D'ORANGE (DONT PULPE 1,6%), JUS DE CLÉMENT...</td>
      <td>192.0</td>
      <td>10.20</td>
      <td>0.60</td>
      <td>0.50</td>
      <td>0.00</td>
      <td>0.600</td>
      <td>9.200</td>
      <td>...</td>
      <td>0.0</td>
      <td>C</td>
      <td>EN:FRUIT-JUICES</td>
      <td>4.0</td>
      <td>-5.0</td>
      <td>169.0</td>
      <td>-5.00</td>
      <td>NaN</td>
      <td>-5.00</td>
      <td>-5.00</td>
    </tr>
    <tr>
      <th>76483</th>
      <td>99111250</td>
      <td>THÉ VERT EARL GREY</td>
      <td>THÉ VERT, ARÔME NATUREL BERGAMOTE AVEC AUTRES ...</td>
      <td>21.0</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.200</td>
      <td>0.500</td>
      <td>...</td>
      <td>0.0</td>
      <td>C</td>
      <td>EN:GREEN-TEAS</td>
      <td>2.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-5.00</td>
      <td>1.0</td>
      <td>-5.00</td>
      <td>-5.00</td>
    </tr>
    <tr>
      <th>76484</th>
      <td>99567453</td>
      <td>MINT MELANGE TEA A BLEND OF PEPPERMINT, LEMON ...</td>
      <td>ORGANIC PEPPERMINT, ORGANIC LEMON GRASS, ORGAN...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>...</td>
      <td>0.0</td>
      <td>B</td>
      <td>AUTRES</td>
      <td>0.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-5.00</td>
      <td>1.0</td>
      <td>-5.00</td>
      <td>-5.00</td>
    </tr>
  </tbody>
</table>
<p>64838 rows × 24 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_k2</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">mix_kmeans_cah</span><span class="o">.</span><span class="n">classe_cah</span><span class="p">)</span>
<span class="n">WGI_k2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;classe&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>energy_100g</th>
      <th>carbohydrates_100g</th>
      <th>proteins_100g</th>
      <th>fat_100g</th>
      <th>saturated_fat_100g</th>
      <th>fiber_100g</th>
      <th>sugars_100g</th>
      <th>salt_100g</th>
      <th>additives_n</th>
      <th>ingredients_from_palm_oil_n</th>
      <th>ingredients_that_may_be_from_palm_oil_n</th>
      <th>nutrition_score_fr_100g</th>
      <th>reg_additives</th>
      <th>reg_energy</th>
      <th>reg_fat</th>
      <th>reg_carbohydrates</th>
      <th>reg_fiber</th>
      <th>reg_protein</th>
    </tr>
    <tr>
      <th>classe</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>396.879121</td>
      <td>13.008956</td>
      <td>4.807692</td>
      <td>3.070055</td>
      <td>0.851648</td>
      <td>1.946703</td>
      <td>6.564121</td>
      <td>1.163010</td>
      <td>1.373626</td>
      <td>0.000000</td>
      <td>0.027473</td>
      <td>2.324176</td>
      <td>-2.703297</td>
      <td>312.554945</td>
      <td>-1.212747</td>
      <td>3.985714</td>
      <td>-1.917308</td>
      <td>1.196758</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>351.839286</td>
      <td>13.494286</td>
      <td>4.570491</td>
      <td>2.678036</td>
      <td>0.949107</td>
      <td>1.435045</td>
      <td>6.939911</td>
      <td>0.780568</td>
      <td>1.303571</td>
      <td>0.004464</td>
      <td>0.008929</td>
      <td>1.758929</td>
      <td>-2.803571</td>
      <td>265.772321</td>
      <td>-2.033661</td>
      <td>3.718391</td>
      <td>-2.364286</td>
      <td>0.516696</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>384.891331</td>
      <td>11.979879</td>
      <td>4.753980</td>
      <td>3.103170</td>
      <td>1.057460</td>
      <td>1.346436</td>
      <td>6.505302</td>
      <td>0.922205</td>
      <td>1.804435</td>
      <td>0.000000</td>
      <td>0.028226</td>
      <td>2.359879</td>
      <td>-2.008065</td>
      <td>293.762097</td>
      <td>-1.238246</td>
      <td>3.758750</td>
      <td>-2.418448</td>
      <td>1.077399</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>383.437126</td>
      <td>12.859162</td>
      <td>4.383952</td>
      <td>2.980060</td>
      <td>1.016228</td>
      <td>1.688922</td>
      <td>6.644132</td>
      <td>0.909298</td>
      <td>1.311377</td>
      <td>0.000000</td>
      <td>0.035928</td>
      <td>1.455090</td>
      <td>-2.748503</td>
      <td>293.425150</td>
      <td>-1.287485</td>
      <td>3.645833</td>
      <td>-1.929641</td>
      <td>0.336707</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>394.851059</td>
      <td>12.352968</td>
      <td>4.797598</td>
      <td>3.054065</td>
      <td>1.033240</td>
      <td>1.446122</td>
      <td>6.467549</td>
      <td>0.897872</td>
      <td>1.679214</td>
      <td>0.001619</td>
      <td>0.037196</td>
      <td>2.267615</td>
      <td>-2.182176</td>
      <td>303.910985</td>
      <td>-1.168973</td>
      <td>3.828431</td>
      <td>-2.269826</td>
      <td>0.922117</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>457.142857</td>
      <td>11.768571</td>
      <td>9.237857</td>
      <td>4.392857</td>
      <td>1.432857</td>
      <td>3.871429</td>
      <td>3.689286</td>
      <td>1.057779</td>
      <td>0.857143</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.285714</td>
      <td>-3.714286</td>
      <td>378.285714</td>
      <td>0.808571</td>
      <td>2.909091</td>
      <td>-0.885714</td>
      <td>4.773571</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">nutrition_grade_fr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">tm</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tm</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aurel\AppData\Roaming\Python\Python39\site-packages\seaborn\_decorators.py:36: FutureWarning:

Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x23a05c0c6a0&gt;
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_112_2.png" src="_images/ScriptFood_Analyse_p4_112_2.png" />
</div>
</div>
</div>
<div class="section" id="f-cah-utilisation-des-variables-quantitatives-avec-regroupement">
<h2>f) CAH : Utilisation des variables quantitatives avec regroupement<a class="headerlink" href="#f-cah-utilisation-des-variables-quantitatives-avec-regroupement" title="Permalink to this headline">¶</a></h2>
<p>Essayons de refaire les calculs avec nos variables “regroupement”</p>
<p>Pour rappel :</p>
<ul class="simple">
<li><p>Points négatifs : l’énergie, les graisses saturées, les sucres, et le sel (des niveaux élevés sont considérés comme mauvais pour la santé)</p></li>
<li><p>Points positifs : la proportion de fruits, de légumes, de noix, d’huiles d’olive, de colza et de noix, de fibres et de protéines (les niveaux élevés sont considérés comme bons pour la santé).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_study</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span>  <span class="c1">#&quot;score_total&quot;,</span>
            <span class="s2">&quot;ingredients_text&quot;</span><span class="p">,</span><span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;proteins_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fat_100g&quot;</span><span class="p">,</span>
            <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fiber_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;salt_100g&quot;</span><span class="p">,</span>
             <span class="s2">&quot;additives_n&quot;</span><span class="p">,</span> <span class="s2">&quot;reg_salt&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="s2">&quot;main_category&quot;</span><span class="p">,</span> <span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span> <span class="s1">&#39;reg_additives&#39;</span><span class="p">,</span>
       <span class="s1">&#39;reg_energy&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_fat&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_carbohydrates&#39;</span><span class="p">,</span> <span class="s1">&#39;reg_fiber&#39;</span><span class="p">,</span> 
       <span class="s1">&#39;reg_protein&#39;</span><span class="p">]]</span>
<span class="n">data_study</span><span class="o">=</span><span class="n">data_study</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_additives</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> 
               <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_carbohydrates</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_fat</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> 
               <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_fiber</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                            <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">nutrition_score_fr_100g</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                           <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                          <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_protein</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
                          <span class="o">&amp;</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">data_study</span><span class="o">.</span><span class="n">reg_salt</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num_t2</span> <span class="o">=</span> <span class="n">data_study</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nutrition_score_fr_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;energy_100g&quot;</span><span class="p">,</span><span class="s2">&quot;main_category&quot;</span><span class="p">,</span> 
                                      <span class="s2">&quot;product_name&quot;</span><span class="p">,</span><span class="s2">&quot;sugars_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;saturated_fat_100g&quot;</span><span class="p">,</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> 
                                      <span class="s2">&quot;ingredients_text&quot;</span><span class="p">,</span><span class="s2">&quot;reg_energy&quot;</span><span class="p">,</span><span class="s2">&quot;salt_100g&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;carbohydrates_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;proteins_100g&quot;</span><span class="p">,</span> <span class="s2">&quot;fat_100g&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;fiber_100g&quot;</span><span class="p">,</span>  <span class="s2">&quot;additives_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_from_palm_oil_n&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredients_that_may_be_from_palm_oil_n&quot;</span><span class="p">])</span>

<span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;reg_salt&#39;, &#39;nutrition_grade_fr&#39;, &#39;reg_additives&#39;, &#39;reg_fat&#39;,
       &#39;reg_carbohydrates&#39;, &#39;reg_fiber&#39;, &#39;reg_protein&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>B    21172
A    19430
C    16351
D     6838
E     1047
Name: nutrition_grade_fr, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_a</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">test_b</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">test_c</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;C&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">test_d</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;D&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">test_e</span><span class="o">=</span><span class="n">WGI_num_t2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">WGI_num_t2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1047</span><span class="p">)</span>

<span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_a</span><span class="p">,</span> <span class="n">test_b</span><span class="p">,</span> <span class="n">test_c</span><span class="p">,</span> <span class="n">test_d</span><span class="p">,</span> <span class="n">test_e</span><span class="p">]</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;reg_salt&#39;, &#39;nutrition_grade_fr&#39;, &#39;reg_additives&#39;, &#39;reg_fat&#39;,
       &#39;reg_carbohydrates&#39;, &#39;reg_fiber&#39;, &#39;reg_protein&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test2</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">del</span> <span class="n">test2</span><span class="p">[</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#librairies pour la CAH</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="c1">#générer la matrice des liens</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
<span class="c1">#affichage du dendrogramme</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;CAH&quot;</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">color_threshold</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_122_0.png" src="_images/ScriptFood_Analyse_p4_122_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#matérialisation des 5 classes (hauteur t = 350)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hierarchical Clustering Dendrogram (truncated)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;sample index or (cluster size)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">test2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">color_threshold</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
           <span class="n">truncate_mode</span> <span class="o">=</span> <span class="s1">&#39;lastp&#39;</span> <span class="p">,</span>   <span class="c1"># afficher uniquement les p derniers clusters fusionnés </span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">12</span> <span class="p">,</span>   <span class="c1"># afficher uniquement les p derniers clusters fusionnés </span>
   
    <span class="n">leaf_font_size</span> <span class="o">=</span> <span class="mf">12.</span> <span class="p">,</span> 
    <span class="n">show_contracted</span> <span class="o">=</span> <span class="kc">True</span>
          <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ScriptFood_Analyse_p4_123_0.png" src="_images/ScriptFood_Analyse_p4_123_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#découpage à la hauteur t = 400 ==&gt; identifiants de 5 groupes obtenus</span>
<span class="n">groupes_cah</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">groupes_cah</span><span class="p">)</span>
<span class="c1">#index triés des groupes</span>
<span class="n">idg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">groupes_cah</span><span class="p">)</span>
<span class="c1">#affichage des observatbbions et leurs groupes</span>
<span class="n">info_groupe</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idg</span><span class="p">],</span><span class="n">groupes_cah</span><span class="p">[</span><span class="n">idg</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5 5 5 ... 5 3 5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WGI_pca_k2</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">classe</span> <span class="o">=</span> <span class="n">info_groupe</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">nutrition_grade_fr</span><span class="p">,</span> <span class="n">WGI_pca_k2</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">nutrition_grade_fr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">)</span>
<span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">tm</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;nutrition_grade_fr&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;classe&quot;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tm</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aurel\AppData\Roaming\Python\Python39\site-packages\seaborn\_decorators.py:36: FutureWarning:

Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x2b3ade84b50&gt;
</pre></div>
</div>
<img alt="_images/ScriptFood_Analyse_p4_126_2.png" src="_images/ScriptFood_Analyse_p4_126_2.png" />
</div>
</div>
<p>Ces résultats sont assez proche du nutriscore. Il y a des poids à mettre en fonction des apports nutritionnels.
Il faut donc appliquer une règle métier pour séparer les groupes qui sont proches A/B et DE.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "venv"
        },
        kernelOptions: {
            kernelName: "venv",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'venv'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="ScriptFood_Analyse_p3.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">III - Est-ce que le nutriscore contribue à améliorer la santé des français ? Dans ce but, est ce que le nutriscore permet de manger équilibrer ?</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ScriptFood_Analyse_p5.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">V - Combinaison des aliments</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          Par Aurélie ANAÏS<br/>
        
            &copy; droits d'auteur 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>